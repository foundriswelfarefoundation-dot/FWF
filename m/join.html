<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
  <meta name="theme-color" content="#0b1220" />
  <title>Join FWF — Membership</title>
  <link rel="manifest" href="../manifest.json">
  <link rel="icon" href="../assets/images/logo.png">
  <link href="../assets/css/fwf-app.css" rel="stylesheet">
  <style>
    /* Benefits list */
    .benefits-list { list-style: none; padding: 0; margin: 0; }
    .benefits-list li {
      display: flex; align-items: center; gap: 10px;
      padding: 9px 0;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      font-size: 14px; color: var(--text2);
    }
    .benefits-list li:last-child { border-bottom: none; }
    .benefits-list li i { color: var(--green); font-size: 14px; flex-shrink: 0; }

    /* Fee badge */
    .fee-badge {
      display: inline-flex; align-items: center; gap: 6px;
      background: rgba(249,115,22,0.15);
      border: 1px solid rgba(249,115,22,0.35);
      border-radius: 50px; padding: 6px 14px;
      font-size: 14px; font-weight: 700; color: var(--primary);
      margin-bottom: 20px;
    }

    /* Step progress nav */
    .step-progress {
      display: flex; align-items: center;
      margin-bottom: 28px; gap: 0;
    }
    .sp-item {
      flex: 1; display: flex; flex-direction: column;
      align-items: center; position: relative;
    }
    .sp-item::after {
      content: ''; position: absolute;
      top: 16px; left: 50%; width: 100%; height: 2px;
      background: var(--border); z-index: 0;
    }
    .sp-item:last-child::after { display: none; }
    .sp-item.done::after { background: var(--primary); }
    .sp-circle {
      width: 32px; height: 32px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 13px; font-weight: 800;
      border: 2px solid var(--border);
      background: rgba(11,18,32,0.9);
      color: var(--text3); z-index: 1; position: relative;
      transition: all .25s;
    }
    .sp-item.active .sp-circle {
      border-color: var(--primary); color: var(--primary);
      background: rgba(249,115,22,0.12);
    }
    .sp-item.done .sp-circle {
      border-color: var(--primary); background: var(--primary); color: #fff;
    }
    .sp-label { font-size: 10px; color: var(--text3); margin-top: 5px; text-transform: uppercase; letter-spacing: .3px; }
    .sp-item.active .sp-label { color: var(--primary); font-weight: 700; }

    /* Form section transitions */
    .form-section { display: none; }
    .form-section.active { display: block; }

    /* Payment info */
    .pay-note {
      background: rgba(59,130,246,0.1);
      border: 1px solid rgba(59,130,246,0.25);
      border-radius: var(--radius-sm);
      padding: 14px 16px; margin-bottom: 16px;
    }
    .pay-note p { font-size: 13px; color: #93c5fd; margin: 0; }
    .pay-note strong { color: var(--text); }

    /* Nav buttons row */
    .nav-btns { display: flex; gap: 10px; margin-top: 4px; }
    .nav-btns .btn { flex: 1; }
  </style>
</head>
<body>

  <!-- Top Bar -->
  <header class="app-topbar">
    <div class="brand">
      <img src="../assets/images/logo.png" alt="FWF">
      <div>
        <div class="brand-text">Join FWF</div>
        <div class="brand-sub">Membership registration</div>
      </div>
    </div>
  </header>

  <div class="app-section">
    <!-- Fee badge -->
    <div class="txt-center mb-16">
      <div class="fee-badge"><i class="fas fa-star"></i> ₹200/month Membership</div>
    </div>

    <!-- Benefits -->
    <div class="glass-card mb-16">
      <h3 style="font-size:15px;margin-bottom:12px;">✨ Membership Benefits</h3>
      <ul class="benefits-list">
        <li><i class="fas fa-check-circle"></i>Free skill training programs</li>
        <li><i class="fas fa-check-circle"></i>Project assignments &amp; earning opportunities</li>
        <li><i class="fas fa-check-circle"></i>One-on-one mentoring sessions</li>
        <li><i class="fas fa-check-circle"></i>Job placement assistance</li>
      </ul>
    </div>

    <!-- Alert -->
    <div id="alertBox" class="app-alert mb-16"></div>

    <!-- Step Progress -->
    <div class="step-progress" id="stepProgress">
      <div class="sp-item active" id="sp1">
        <div class="sp-circle">1</div>
        <div class="sp-label">Personal</div>
      </div>
      <div class="sp-item" id="sp2">
        <div class="sp-circle">2</div>
        <div class="sp-label">Contact</div>
      </div>
      <div class="sp-item" id="sp3">
        <div class="sp-circle">3</div>
        <div class="sp-label">Payment</div>
      </div>
    </div>

    <!-- Form -->
    <form id="joinForm">

      <!-- Step 1: Personal -->
      <div class="form-section active glass-card" id="step1">
        <h3 style="font-size:16px;margin-bottom:18px;">Personal Information</h3>

        <div class="form-group">
          <label class="form-label">Full Name *</label>
          <input class="form-input" type="text" name="fullName" required placeholder="Enter your full name">
        </div>
        <div class="form-group">
          <label class="form-label">Gender *</label>
          <select class="form-select" name="gender" required>
            <option value="">Select gender</option>
            <option value="female">Female</option>
            <option value="male">Male</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Date of Birth *</label>
          <input class="form-input" type="date" name="dob" required>
        </div>
        <div class="form-group">
          <label class="form-label">Marital Status *</label>
          <select class="form-select" name="maritalStatus" required>
            <option value="">Select status</option>
            <option value="single">Single</option>
            <option value="married">Married</option>
            <option value="widowed">Widowed</option>
            <option value="divorced">Divorced</option>
          </select>
        </div>

        <button type="button" class="btn btn-primary btn-block" onclick="nextStep(2)">
          Next <i class="fas fa-arrow-right"></i>
        </button>
      </div>

      <!-- Step 2: Contact -->
      <div class="form-section glass-card" id="step2">
        <h3 style="font-size:16px;margin-bottom:18px;">Contact Details</h3>

        <div class="form-group">
          <label class="form-label">Mobile Number *</label>
          <input class="form-input" type="tel" name="mobile" required pattern="[0-9]{10}" placeholder="10-digit mobile">
        </div>
        <div class="form-group">
          <label class="form-label">WhatsApp Number</label>
          <input class="form-input" type="tel" name="whatsapp" pattern="[0-9]{10}" placeholder="Optional">
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input class="form-input" type="email" name="email" placeholder="Optional">
        </div>
        <div class="form-group">
          <label class="form-label">Address *</label>
          <textarea class="form-textarea" name="address" required rows="2" placeholder="Complete address"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">City *</label>
          <input class="form-input" type="text" name="city" required placeholder="Your city">
        </div>
        <div class="form-group">
          <label class="form-label">State *</label>
          <input class="form-input" type="text" name="state" required placeholder="Your state">
        </div>
        <div class="form-group">
          <label class="form-label">PIN Code *</label>
          <input class="form-input" type="text" name="pincode" required pattern="[0-9]{6}" placeholder="6-digit PIN">
        </div>

        <div class="nav-btns">
          <button type="button" class="btn btn-secondary" onclick="prevStep(1)">
            <i class="fas fa-arrow-left"></i> Back
          </button>
          <button type="button" class="btn btn-primary" onclick="nextStep(3)">
            Next <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>

      <!-- Step 3: Payment -->
      <div class="form-section glass-card" id="step3">
        <h3 style="font-size:16px;margin-bottom:14px;">Payment Details</h3>

        <div class="pay-note">
          <p><strong>₹200 Membership Fee</strong> — Pay via UPI or Bank Transfer and upload screenshot</p>
        </div>

        <div class="form-group">
          <label class="form-label">Payment Method *</label>
          <select class="form-select" name="paymentMethod" required>
            <option value="">Select method</option>
            <option value="upi">UPI</option>
            <option value="bank">Bank Transfer</option>
            <option value="cash">Cash</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Transaction ID / Reference</label>
          <input class="form-input" type="text" name="transactionId" placeholder="Optional">
        </div>

        <div class="form-group">
          <label class="form-label">Payment Screenshot *</label>
          <div class="file-zone" onclick="document.getElementById('paymentProof').click()">
            <input type="file" id="paymentProof" name="paymentProof" accept="image/*" required
              onchange="previewImage(this, 'paymentPreview')" style="display:none;">
            <div id="paymentPreview">
              <i class="fas fa-cloud-upload-alt"></i>
              <p><strong>Tap to upload payment proof</strong></p>
              <p style="font-size:11px;color:var(--text3);margin:0;">JPG, PNG (Max 5MB)</p>
            </div>
          </div>
        </div>

        <label class="check-row mb-16">
          <input type="checkbox" name="agreeTerms" required>
          <span>I agree to <a href="../terms.html" target="_blank">Terms &amp; Conditions</a></span>
        </label>

        <div class="nav-btns">
          <button type="button" class="btn btn-secondary" onclick="prevStep(2)">
            <i class="fas fa-arrow-left"></i> Back
          </button>
          <button type="submit" class="btn btn-primary" id="submitBtn">
            Submit <i class="fas fa-check"></i>
          </button>
        </div>
      </div>

    </form>
  </div>

  <!-- Rich Footer -->
  <footer class="app-footer">
    <div class="footer-brand-row">
      <img src="../assets/images/logo.png" alt="FWF">
      <div>
        <div class="footer-brand-name">FWF</div>
        <div class="footer-brand-tagline">Foundris Welfare Foundation</div>
      </div>
    </div>
    <div class="footer-bar" style="border-top:none;padding-top:0;">
      <span class="footer-bar-copy">&copy; 2026 FWF. All rights reserved.</span>
      <div class="footer-bar-links">
        <a href="../privacy.html">Privacy</a>
        <a href="../terms.html">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Bottom Tab Bar -->
  <nav class="app-tabs">
    <a href="index.html" class="tab-item">
      <i class="fas fa-home"></i><span>Home</span>
    </a>
    <a href="projects.html" class="tab-item">
      <i class="fas fa-briefcase"></i><span>Projects</span>
    </a>
    <a href="join.html" class="tab-item tab-join active">
      <div class="tab-fab"><i class="fas fa-plus"></i></div>
      <span>Join</span>
    </a>
    <a href="donation.html" class="tab-item">
      <i class="fas fa-heart"></i><span>Donate</span>
    </a>
    <a href="member-login.html" class="tab-item">
      <i class="fas fa-user"></i><span>Login</span>
    </a>
  </nav>

  <script>
    let currentStep = 1;

    function showAlert(msg, type) {
      const a = document.getElementById('alertBox');
      a.textContent = msg;
      a.className = 'app-alert show ' + type;
      setTimeout(() => a.classList.remove('show'), 5000);
    }

    function nextStep(step) {
      const cur = document.getElementById('step' + currentStep);
      const req = cur.querySelectorAll('input[required], select[required], textarea[required]');
      let valid = true;
      req.forEach(inp => {
        if (!inp.value) {
          valid = false;
          inp.style.borderColor = '#ef4444';
          inp.addEventListener('input', () => inp.style.borderColor = '', { once: true });
        }
      });
      if (!valid) { showAlert('Please fill all required fields', 'error'); return; }

      cur.classList.remove('active');
      document.getElementById('sp' + currentStep).classList.remove('active');
      document.getElementById('sp' + currentStep).classList.add('done');
      // mark connector line
      if (currentStep < 3) document.getElementById('sp' + currentStep).classList.add('done');

      currentStep = step;
      document.getElementById('step' + currentStep).classList.add('active');
      document.getElementById('sp' + currentStep).classList.add('active');
      window.scrollTo(0, 0);
    }

    function prevStep(step) {
      document.getElementById('step' + currentStep).classList.remove('active');
      document.getElementById('sp' + currentStep).classList.remove('active');

      currentStep = step;
      document.getElementById('step' + currentStep).classList.add('active');
      document.getElementById('sp' + currentStep).classList.remove('done');
      document.getElementById('sp' + currentStep).classList.add('active');
      window.scrollTo(0, 0);
    }

    function previewImage(input, previewId) {
      const preview = document.getElementById(previewId);
      const file = input.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          preview.innerHTML = `<img src="${e.target.result}" style="max-width:100%;max-height:180px;border-radius:8px;" alt="Preview">`;
        };
        reader.readAsDataURL(file);
      }
    }

    document.getElementById('joinForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
      try {
        const res = await fetch('/api/join', { method: 'POST', body: new FormData(this) });
        const data = await res.json();
        if (data.ok || res.ok) {
          showAlert('✅ Application submitted! Check your mobile for member ID.', 'success');
          setTimeout(() => window.location.href = 'member-login.html', 3000);
        } else {
          throw new Error(data.error || 'Submission failed');
        }
      } catch(err) {
        showAlert('❌ ' + err.message, 'error');
      } finally {
        btn.disabled = false;
        btn.innerHTML = 'Submit <i class="fas fa-check"></i>';
      }
    });

    if (window.history.replaceState) {
      window.history.replaceState(null, null, window.location.href);
    }
  </script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
</body>
</html>
