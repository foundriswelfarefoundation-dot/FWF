<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Member Dashboard ‚Äî FWF</title>
  <link rel="icon" type="image/png" href="assets/images/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <style>
/* ==============================
   CSS VARIABLES
   ============================== */
:root {
  --bg-1:#f0f2f8; --bg-2:#e8ecf4;
  --accent:#6366f1; --accent2:#ec4899; --accent-soft:rgba(99,102,241,.1);
  --sidebar-bg:linear-gradient(180deg,#0f172a 0%,#1e293b 100%);
  --sidebar-text:#94a3b8;
  --card-bg:#ffffff; --card-border:#e2e8f0;
  --text-primary:#0f172a; --text-secondary:#475569; --text-muted:#94a3b8;
  --success:#22c55e; --warning:#f59e0b; --danger:#ef4444; --info:#3b82f6;
}

*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Plus Jakarta Sans',system-ui,sans-serif;
  background:var(--bg-1);
  min-height:100vh; color:var(--text-primary);
  display:flex;
}
a{color:inherit;text-decoration:none}

/* ==============================
   SIDEBAR
   ============================== */
.sidebar{
  position:fixed; left:0; top:0; bottom:0; width:260px; z-index:100;
  background:var(--sidebar-bg);
  display:flex; flex-direction:column;
  padding:20px 14px 14px;
  transition:transform .3s ease;
}
.sidebar-brand{
  display:flex; align-items:center; gap:12px;
  padding:4px 10px 20px; border-bottom:1px solid rgba(255,255,255,.08);
  margin-bottom:14px;
}
.sidebar-brand img{ width:40px; height:40px; border-radius:10px; }
.sidebar-brand span{ font-size:18px; font-weight:900; color:#fff; }
.sidebar-brand small{ display:block; font-size:11px; color:#22c55e; font-weight:700; margin-top:2px; }
.sidebar-nav{ flex:1; display:flex; flex-direction:column; gap:3px; overflow-y:auto; }
.nav-item{
  display:flex; align-items:center; gap:12px;
  padding:11px 14px; border-radius:10px;
  font-size:13px; font-weight:700;
  color:var(--sidebar-text); opacity:.7;
  cursor:pointer; transition:all .2s;
  border:none; background:none; width:100%; text-align:left;
  font-family:inherit;
}
.nav-item:hover{ opacity:1; background:rgba(255,255,255,.06); }
.nav-item.active{
  opacity:1; background:rgba(99,102,241,.15); color:#818cf8;
  box-shadow:inset 3px 0 0 #6366f1;
}
.nav-item i{ width:18px; text-align:center; font-size:14px; }
.nav-badge{
  margin-left:auto; background:#ef4444; color:#fff;
  padding:2px 7px; border-radius:99px; font-size:10px; font-weight:800;
}
.nav-divider{
  font-size:10px; font-weight:800; color:rgba(255,255,255,.25);
  text-transform:uppercase; letter-spacing:1px;
  padding:16px 14px 6px; user-select:none;
}
.sidebar-footer{
  border-top:1px solid rgba(255,255,255,.08);
  padding-top:12px; margin-top:auto;
}
.nav-item.logout-btn{ color:#f87171; opacity:.9; }

/* ==============================
   MOBILE
   ============================== */
.mobile-toggle{
  display:none; position:fixed; top:14px; left:14px; z-index:200;
  width:42px; height:42px; border-radius:10px;
  background:#fff; border:1px solid var(--card-border);
  box-shadow:0 4px 12px rgba(0,0,0,.06);
  font-size:16px; cursor:pointer; color:var(--text-primary);
  font-family:inherit;
}
.mobile-overlay{
  display:none; position:fixed; inset:0; z-index:90;
  background:rgba(0,0,0,.4); backdrop-filter:blur(4px);
}

/* ==============================
   MAIN
   ============================== */
.main{
  flex:1; margin-left:260px;
  padding:20px 28px;
  min-height:100vh;
}

.topbar{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:24px; flex-wrap:wrap; gap:14px;
}
.topbar h1{
  font-size:24px; font-weight:900; letter-spacing:-.5px;
}
.topbar-right{ display:flex; align-items:center; gap:10px; }
.member-badge{
  display:inline-flex; align-items:center; gap:6px;
  background:linear-gradient(135deg,#22c55e,#059669);
  color:#fff; padding:6px 14px; border-radius:99px;
  font-size:12px; font-weight:800;
}

/* ==============================
   PAGES
   ============================== */
.page{ display:none; animation:fadeIn .3s ease; }
.page.active{ display:block; }
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

/* ==============================
   STAT CARDS
   ============================== */
.stats-row{
  display:grid; grid-template-columns:repeat(4,1fr); gap:16px;
  margin-bottom:24px;
}
.stat-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; padding:20px;
  box-shadow:0 2px 8px rgba(0,0,0,.03);
  transition:transform .2s, box-shadow .2s;
  position:relative; overflow:hidden;
}
.stat-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.06); }
.stat-card .s-icon{
  width:40px; height:40px; border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  font-size:18px; margin-bottom:12px; color:#fff;
}
.stat-card .s-label{
  font-size:11px; font-weight:700; color:var(--text-muted);
  text-transform:uppercase; letter-spacing:.5px; margin-bottom:4px;
}
.stat-card .s-value{
  font-size:26px; font-weight:900; color:var(--text-primary);
  letter-spacing:-.5px;
}
.stat-card .s-sub{ font-size:11px; color:var(--text-secondary); margin-top:2px; font-weight:600; }
.s-purple{ background:linear-gradient(135deg,#6366f1,#8b5cf6); }
.s-green{ background:linear-gradient(135deg,#22c55e,#059669); }
.s-blue{ background:linear-gradient(135deg,#3b82f6,#2563eb); }
.s-amber{ background:linear-gradient(135deg,#f59e0b,#d97706); }
.s-pink{ background:linear-gradient(135deg,#ec4899,#be185d); }
.s-red{ background:linear-gradient(135deg,#ef4444,#dc2626); }
.s-cyan{ background:linear-gradient(135deg,#06b6d4,#0891b2); }
.s-teal{ background:linear-gradient(135deg,#14b8a6,#0d9488); }

/* ==============================
   CONTENT CARD
   ============================== */
.content-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; padding:22px;
  box-shadow:0 2px 8px rgba(0,0,0,.03);
  margin-bottom:18px;
}
.content-card h3{
  font-size:16px; font-weight:800; margin-bottom:14px;
  display:flex; align-items:center; gap:8px;
}
.content-card h3 i{ color:var(--accent); font-size:14px; }

/* ==============================
   GRIDS
   ============================== */
.grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:18px; }
.grid-3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:18px; }

/* ==============================
   TABLE
   ============================== */
.data-table{ width:100%; border-collapse:collapse; }
.data-table th{
  text-align:left; font-size:10px; font-weight:700;
  color:var(--text-muted); text-transform:uppercase; letter-spacing:.5px;
  padding:8px 12px; border-bottom:2px solid var(--card-border);
  white-space:nowrap;
}
.data-table td{
  padding:10px 12px; border-bottom:1px solid #f1f5f9;
  font-size:13px; font-weight:600; color:var(--text-secondary);
}
.data-table tr:hover td{ background:#f8faff; }
.data-table tr:last-child td{ border-bottom:0; }
.badge{
  display:inline-flex; padding:3px 9px; border-radius:99px;
  font-size:10px; font-weight:800; white-space:nowrap;
}
.b-active{ background:#dcfce7; color:#166534; }
.b-inactive{ background:#fee2e2; color:#991b1b; }
.b-open{ background:#dbeafe; color:#1e40af; }
.b-progress{ background:#fef3c7; color:#92400e; }
.b-resolved{ background:#d1fae5; color:#065f46; }
.b-closed{ background:#e2e8f0; color:#475569; }
.b-pending{ background:#fff7ed; color:#9a3412; }

/* ==============================
   FORMS
   ============================== */
.form-group{ margin-bottom:14px; }
.form-group label{
  display:block; font-size:12px; font-weight:700;
  color:var(--text-secondary); margin-bottom:4px;
}
.form-input{
  width:100%; padding:10px 14px;
  border:2px solid var(--card-border); border-radius:10px;
  background:#fff; color:var(--text-primary);
  font:inherit; font-size:13px; font-weight:600;
  transition:border-color .2s;
}
.form-input:focus{
  outline:none; border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-soft);
}
.form-row{ display:flex; gap:12px; flex-wrap:wrap; }
.form-row .form-group{ flex:1; min-width:180px; }
select.form-input{
  appearance:none; cursor:pointer;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%2394a3b8" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>');
  background-repeat:no-repeat; background-position:right 12px center;
  padding-right:36px;
}
textarea.form-input{ resize:vertical; min-height:80px; }

/* ==============================
   BUTTONS
   ============================== */
.btn{
  padding:8px 18px; border:none; border-radius:10px;
  font:inherit; font-size:12px; font-weight:800;
  cursor:pointer; display:inline-flex; align-items:center; gap:6px;
  transition:all .2s;
}
.btn-primary{ background:var(--accent); color:#fff; }
.btn-primary:hover{ background:#4f46e5; }
.btn-success{ background:var(--success); color:#fff; }
.btn-danger{ background:var(--danger); color:#fff; }
.btn-warning{ background:var(--warning); color:#fff; }
.btn-ghost{
  background:transparent; color:var(--text-secondary);
  border:1px solid var(--card-border);
}
.btn-ghost:hover{ background:#f1f5f9; }
.btn-sm{ padding:5px 10px; font-size:11px; border-radius:8px; }
.btn-icon{
  width:32px; height:32px; border-radius:8px; padding:0;
  display:inline-flex; align-items:center; justify-content:center;
  border:1px solid var(--card-border); background:#fff;
  cursor:pointer; transition:.2s; font-size:13px; color:var(--text-secondary);
}
.btn-icon:hover{ background:#f1f5f9; }

/* ==============================
   WELCOME BANNER
   ============================== */
.welcome-banner{
  background:linear-gradient(135deg,#6366f1,#8b5cf6,#ec4899);
  border-radius:20px; padding:32px; color:#fff;
  margin-bottom:24px; position:relative; overflow:hidden;
}
.welcome-banner::after{
  content:''; position:absolute; right:-40px; top:-40px;
  width:200px; height:200px; border-radius:50%;
  background:rgba(255,255,255,.08);
}
.welcome-banner h2{ font-size:28px; font-weight:900; margin-bottom:6px; }
.welcome-banner p{ opacity:.85; font-weight:600; font-size:14px; }
.welcome-banner .wid{ 
  display:inline-flex; align-items:center; gap:8px;
  background:rgba(255,255,255,.2); padding:6px 16px; border-radius:99px;
  font-size:13px; font-weight:800; margin-top:12px; backdrop-filter:blur(4px);
}

/* ==============================
   PROFILE CARD
   ============================== */
.profile-header{
  display:flex; align-items:center; gap:20px;
  margin-bottom:20px; padding-bottom:20px;
  border-bottom:1px solid var(--card-border);
}
.profile-avatar{
  width:80px; height:80px; border-radius:50%;
  background:linear-gradient(135deg,#6366f1,#ec4899);
  color:#fff; display:flex; align-items:center; justify-content:center;
  font-size:32px; font-weight:900; flex-shrink:0;
}
.profile-name{ font-size:24px; font-weight:900; }
.profile-id{ color:var(--accent); font-weight:700; font-size:14px; margin-top:2px; }
.profile-meta{ display:flex; gap:20px; flex-wrap:wrap; margin-top:8px; }
.profile-meta span{
  font-size:12px; color:var(--text-muted); font-weight:600;
  display:flex; align-items:center; gap:4px;
}

/* ==============================
   ACTIVITY FEED
   ============================== */
.feed-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; padding:20px 22px; margin-bottom:14px;
  transition:box-shadow .2s;
}
.feed-card:hover{ box-shadow:0 4px 16px rgba(0,0,0,.06); }
.feed-header{
  display:flex; align-items:center; gap:12px; margin-bottom:12px;
}
.feed-avatar{
  width:40px; height:40px; border-radius:50%;
  background:linear-gradient(135deg,#6366f1,#8b5cf6);
  color:#fff; display:flex; align-items:center; justify-content:center;
  font-size:14px; font-weight:900;
}
.feed-name{ font-weight:800; font-size:14px; }
.feed-time{ font-size:11px; color:var(--text-muted); font-weight:600; }
.feed-body{ font-size:14px; line-height:1.7; color:var(--text-secondary); margin-bottom:12px; }
.feed-image{
  width:100%; border-radius:12px; max-height:320px;
  object-fit:cover; margin-bottom:12px;
}
.feed-actions{
  display:flex; gap:16px;
}
.feed-actions button{
  background:none; border:none; cursor:pointer;
  font:inherit; font-size:13px; font-weight:700;
  color:var(--text-muted); display:flex; align-items:center; gap:6px;
  transition:color .2s;
}
.feed-actions button:hover{ color:var(--accent); }

/* ==============================
   COURSE CARD
   ============================== */
.course-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; overflow:hidden;
  transition:transform .2s, box-shadow .2s;
}
.course-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.06); }
.course-thumb{
  height:140px; background:linear-gradient(135deg,#6366f1,#8b5cf6);
  display:flex; align-items:center; justify-content:center;
  font-size:48px; color:rgba(255,255,255,.3);
}
.course-info{ padding:16px; }
.course-info h4{ font-size:14px; font-weight:800; margin-bottom:6px; }
.course-info p{ font-size:12px; color:var(--text-muted); font-weight:600; margin-bottom:10px; }
.course-progress{
  height:6px; background:#e2e8f0; border-radius:99px; overflow:hidden;
}
.course-progress-bar{
  height:100%; background:linear-gradient(90deg,#6366f1,#22c55e);
  border-radius:99px; transition:width .5s;
}
.course-status{
  display:flex; justify-content:space-between; align-items:center;
  margin-top:8px; font-size:11px; font-weight:700;
}

/* ==============================
   REDEEM CARD
   ============================== */
.redeem-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; padding:20px; text-align:center;
  transition:transform .2s, box-shadow .2s;
}
.redeem-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.06); }
.redeem-icon{
  width:56px; height:56px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:24px; color:#fff; margin:0 auto 12px;
}
.redeem-card h4{ font-size:14px; font-weight:800; margin-bottom:4px; }
.redeem-card p{ font-size:12px; color:var(--text-muted); font-weight:600; margin-bottom:12px; }
.redeem-cost{ font-size:13px; font-weight:800; color:var(--accent); margin-bottom:8px; }

/* ==============================
   WALLET TABS
   ============================== */
.wallet-tab{
  padding:12px 24px; border:none; background:transparent;
  font-size:13px; font-weight:800; color:var(--text-muted);
  cursor:pointer; border-bottom:3px solid transparent;
  transition:all .2s; font-family:inherit;
  white-space:nowrap; position:relative;
}
.wallet-tab:hover{ 
  color:var(--text-primary); 
  background:rgba(99,102,241,.05);
  border-radius:8px 8px 0 0;
}
.wallet-tab.active{
  color:var(--accent); 
  border-bottom-color:var(--accent);
  background:rgba(99,102,241,.08);
  border-radius:8px 8px 0 0;
}
.wallet-tab i{ margin-right:6px; }
.wallet-section{ 
  animation:fadeIn .3s; 
}
.wallet-section h3{
  display:flex;
  align-items:center;
  gap:10px;
  padding-bottom:12px;
  border-bottom:2px solid var(--card-border);
  margin-bottom:20px;
}
@keyframes fadeIn{ from{opacity:0} to{opacity:1} }

/* ==============================
   PRODUCT CARD (Marketplace)
   ============================== */
.product-card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:16px; overflow:hidden;
  transition:transform .2s, box-shadow .2s;
}
.product-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.06); }
.product-thumb{
  height:160px; background:#f1f5f9;
  display:flex; align-items:center; justify-content:center;
  font-size:48px; color:var(--text-muted); opacity:.3;
}
.product-info{ padding:14px; }
.product-info h4{ font-size:14px; font-weight:800; margin-bottom:4px; }
.product-info .seller{ font-size:11px; color:var(--text-muted); font-weight:600; margin-bottom:6px; }
.product-price{ font-size:18px; font-weight:900; color:var(--accent); }
.product-rating{ font-size:12px; color:#f59e0b; margin-top:4px; }

/* ==============================
   EVENT CARD
   ============================== */
.event-card{
  display:flex; gap:16px; align-items:center;
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:14px; padding:16px 18px; margin-bottom:10px;
  transition:box-shadow .2s;
}
.event-card:hover{ box-shadow:0 4px 16px rgba(0,0,0,.06); }
.event-date{
  width:54px; height:54px; border-radius:12px;
  background:linear-gradient(135deg,var(--accent),#8b5cf6);
  color:#fff; display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  flex-shrink:0;
}
.event-date .day{ font-size:20px; font-weight:900; line-height:1; }
.event-date .month{ font-size:10px; font-weight:700; text-transform:uppercase; }
.event-info h4{ font-size:14px; font-weight:800; margin-bottom:2px; }
.event-info p{ font-size:12px; color:var(--text-muted); font-weight:600; }

/* ==============================
   TABS
   ============================== */
.tab-bar{
  display:flex; gap:6px; margin-bottom:16px;
  border-bottom:2px solid var(--card-border);
}
.tab-btn{
  padding:8px 16px; border:none; background:none;
  font:inherit; font-size:12px; font-weight:800;
  color:var(--text-muted); cursor:pointer;
  border-bottom:2px solid transparent;
  margin-bottom:-2px; transition:.2s;
}
.tab-btn:hover{ color:var(--text-primary); }
.tab-btn.active{ color:var(--accent); border-bottom-color:var(--accent); }
.tab-content{ display:none; }
.tab-content.active{ display:block; }

/* ==============================
   MODAL
   ============================== */
.modal{
  position:fixed; inset:0; z-index:999;
  background:rgba(15,23,42,.5); backdrop-filter:blur(6px);
  display:none; align-items:center; justify-content:center;
  padding:20px; animation:fadeIn .2s;
}
.modal.show{ display:flex; }
.modal-content{
  background:#fff; border-radius:18px;
  max-width:640px; width:100%; padding:0;
  box-shadow:0 24px 60px rgba(0,0,0,.2);
  max-height:85vh; overflow:hidden;
  animation:scaleIn .3s cubic-bezier(.34,1.56,.64,1);
  display:flex; flex-direction:column;
}
.modal-header{
  display:flex; justify-content:space-between; align-items:center;
  padding:24px 28px 20px;
  border-bottom:1px solid var(--card-border);
}
.modal-header h3{ 
  font-size:18px; font-weight:900; 
  display:flex; align-items:center; gap:8px; 
  margin:0;
}
.modal-header h3 i{ color:var(--accent); }
.modal-body{
  padding:24px 28px;
  overflow-y:auto;
  flex:1;
}
.modal-actions{ 
  display:flex; gap:10px; justify-content:flex-end; 
  padding:20px 28px;
  border-top:1px solid var(--card-border);
  background:var(--bg-1);
}
.modal-overlay{
  position:fixed; inset:0; z-index:999;
  background:rgba(15,23,42,.5); backdrop-filter:blur(6px);
  display:flex; align-items:center; justify-content:center;
  padding:20px; animation:fadeIn .2s;
}
.modal-overlay.hidden{ display:none; }
.modal-card{
  background:#fff; border-radius:18px;
  max-width:640px; width:100%; padding:28px;
  box-shadow:0 24px 60px rgba(0,0,0,.2);
  max-height:85vh; overflow-y:auto;
  animation:scaleIn .3s cubic-bezier(.34,1.56,.64,1);
}
@keyframes scaleIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.modal-head{
  display:flex; justify-content:space-between; align-items:center;
  margin-bottom:18px;
}
.modal-head h3{ font-size:18px; font-weight:900; display:flex; align-items:center; gap:8px; }
.modal-head h3 i{ color:var(--accent); }
.modal-close{
  width:34px; height:34px; border-radius:10px;
  border:1px solid var(--card-border); background:#fff;
  cursor:pointer; font-size:14px; display:grid; place-items:center;
  transition:.2s;
}
.modal-close:hover{ background:#f1f5f9; }
.modal-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:18px; }

/* ==============================
   SELLER PANEL
   ============================== */
.seller-stat{
  text-align:center; padding:16px;
}
.seller-stat .val{ font-size:28px; font-weight:900; color:var(--text-primary); }
.seller-stat .lbl{ font-size:11px; font-weight:700; color:var(--text-muted); text-transform:uppercase; margin-top:2px; }

/* ==============================
   RESPONSIVE
   ============================== */
@media(max-width:1100px){
  .stats-row{ grid-template-columns:repeat(2,1fr); }
  .grid-3{ grid-template-columns:1fr 1fr; }
}
@media(max-width:900px){
  .sidebar{ transform:translateX(-100%); }
  .sidebar.open{ transform:translateX(0); }
  .main{ margin-left:0; padding:16px; padding-top:60px; }
  .mobile-toggle{ display:grid; place-items:center; }
  .mobile-overlay.show{ display:block; }
}
@media(max-width:640px){
  .stats-row{ grid-template-columns:1fr; }
  .grid-2,.grid-3{ grid-template-columns:1fr; }
  .form-row{ flex-direction:column; }
  .topbar{ flex-direction:column; align-items:flex-start; }
  .topbar h1{ font-size:20px; }
  .welcome-banner h2{ font-size:22px; }
  .profile-header{ flex-direction:column; text-align:center; }
  .profile-meta{ justify-content:center; }
  .tab-bar{ overflow-x:auto; }
}
.table-wrap{ overflow-x:auto; }
  </style>
</head>
<body>

<!-- Mobile toggle -->
<button class="mobile-toggle" id="mobileToggle"><i class="fa-solid fa-bars"></i></button>
<div class="mobile-overlay" id="mobileOverlay"></div>

<!-- ======== SIDEBAR ======== -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <img src="assets/images/logo.png" alt="FWF">
    <div>
      <small>MEMBER PANEL</small>
    </div>
  </div>
  <nav class="sidebar-nav">
    <button class="nav-item active" data-page="home">
      <i class="fa-solid fa-house"></i> Dashboard
    </button>

    <div class="nav-divider">Membership</div>
    <button class="nav-item" data-page="profile">
      <i class="fa-solid fa-id-card"></i> Profile & ID Card
    </button>

    <div class="nav-divider">Engage</div>
    <button class="nav-item" data-page="feed">
      <i class="fa-solid fa-camera"></i> Social Work Feed
    </button>
    <button class="nav-item" data-page="training">
      <i class="fa-solid fa-graduation-cap"></i> Training & Courses
    </button>

    <div class="nav-divider">Wallet</div>
    <button class="nav-item" data-page="wallet">
      <i class="fa-solid fa-wallet"></i> Wallet
    </button>

    <div class="nav-divider">Marketplace</div>
    <button class="nav-item" data-page="marketplace">
      <i class="fa-solid fa-store"></i> Marketplace
    </button>
    <button class="nav-item" data-page="seller">
      <i class="fa-solid fa-boxes-stacked"></i> Seller Panel
    </button>

    <div class="nav-divider">More</div>
    <button class="nav-item" data-page="events">
      <i class="fa-solid fa-calendar-days"></i> Events & Activities
    </button>
    <button class="nav-item" data-page="support">
      <i class="fa-solid fa-headset"></i> Help & Support
    </button>
  </nav>
  <div class="sidebar-footer">
    <button class="nav-item logout-btn" id="logoutBtn">
      <i class="fa-solid fa-right-from-bracket"></i> Logout
    </button>
  </div>
</aside>

<!-- ======== MAIN ======== -->
<main class="main">
  <div class="topbar">
    <h1 id="pageTitle"><i class="fa-solid fa-house"></i> Dashboard</h1>
    <div class="topbar-right">
      <span class="member-badge" id="memberBadge"><i class="fa-solid fa-circle-check"></i> Member</span>
    </div>
  </div>

  <!-- ===================== HOME / DASHBOARD ===================== -->
  <div class="page active" id="page-home">
    <div class="welcome-banner" id="welcomeBanner">
      <h2 id="welcomeName">Welcome Back!</h2>
      <p>Empowering women through skills, welfare & self-employment.</p>
      <div class="wid"><i class="fa-solid fa-id-badge"></i> <span id="welcomeId">FWF-000000</span></div>
    </div>

    <div class="stats-row">
      <div class="stat-card">
        <div class="s-icon s-purple"><i class="fa-solid fa-star"></i></div>
        <div class="s-label">Total Points</div>
        <div class="s-value" id="hPoints">0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-green"><i class="fa-solid fa-wallet"></i></div>
        <div class="s-label">Wallet Balance</div>
        <div class="s-value" id="hWallet">‚Çπ0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-blue"><i class="fa-solid fa-user-plus"></i></div>
        <div class="s-label">Referrals</div>
        <div class="s-value" id="hReferrals">0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-amber"><i class="fa-solid fa-hand-holding-heart"></i></div>
        <div class="s-label">Donations Collected</div>
        <div class="s-value" id="hDonations">‚Çπ0</div>
      </div>
    </div>

    <div class="grid-2">
      <div class="content-card">
        <h3><i class="fa-solid fa-chart-line"></i> Quick Actions</h3>
        <div style="display:flex;flex-wrap:wrap;gap:10px">
          <button class="btn btn-primary" onclick="switchPage('wallet')"><i class="fa-solid fa-coins"></i> Earn Points</button>
          <button class="btn btn-success" onclick="switchPage('training')"><i class="fa-solid fa-graduation-cap"></i> Start Course</button>
          <button class="btn btn-warning" onclick="switchPage('marketplace')"><i class="fa-solid fa-store"></i> Marketplace</button>
          <button class="btn btn-ghost" onclick="switchPage('support')"><i class="fa-solid fa-headset"></i> Help</button>
        </div>
      </div>
      <div class="content-card">
        <h3><i class="fa-solid fa-clock"></i> Recent Activity</h3>
        <div id="homeActivity">
          <div class="empty-state"><p>No recent activity</p></div>
        </div>
      </div>
    </div>

    <!-- Member ID Card -->
    <div class="content-card" style="margin-top:18px">
      <h3><i class="fa-solid fa-id-card"></i> Your Member ID Card</h3>
      <div style="max-width:500px;margin:16px auto 0">
        <div style="background:linear-gradient(135deg,#0f172a,#1e293b);border-radius:16px;padding:24px;color:#fff;position:relative;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.2)">
          <div style="position:absolute;right:-20px;top:-20px;width:140px;height:140px;border-radius:50%;background:rgba(99,102,241,.15)"></div>
          <div style="position:absolute;left:-30px;bottom:-30px;width:100px;height:100px;border-radius:50%;background:rgba(236,72,153,.1)"></div>
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;position:relative;z-index:1">
            <img src="assets/images/logo.png" alt="FWF" style="width:44px;height:44px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.3)">
            <div>
              <div style="font-size:17px;font-weight:900;letter-spacing:-.3px">Foundris Welfare Foundation</div>
              <div style="font-size:10px;opacity:.7;font-weight:700;text-transform:uppercase;letter-spacing:.5px">Member Identity Card</div>
            </div>
          </div>
          <div style="position:relative;z-index:1">
            <div style="font-size:24px;font-weight:900;margin-bottom:6px;letter-spacing:-.5px" id="dashCardName">Member Name</div>
            <div style="display:inline-flex;align-items:center;gap:8px;background:rgba(129,140,248,.2);padding:6px 14px;border-radius:8px;margin-bottom:18px">
              <i class="fa-solid fa-id-badge" style="color:#818cf8"></i>
              <span style="font-size:15px;font-weight:800;color:#a5b4fc" id="dashCardId">FWF-000000</span>
            </div>
            <div style="display:flex;gap:24px;font-size:12px;opacity:.85;font-weight:600;flex-wrap:wrap">
              <span><i class="fa-solid fa-phone" style="margin-right:6px;color:#818cf8"></i><span id="dashCardMobile">‚Äî</span></span>
              <span><i class="fa-solid fa-calendar" style="margin-right:6px;color:#818cf8"></i>Joined <span id="dashCardJoined">‚Äî</span></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== PROFILE & ID CARD ===================== -->
  <div class="page" id="page-profile">
    <div class="content-card">
      <div class="profile-header">
        <div class="profile-avatar" id="profileAvatar">M</div>
        <div>
          <div class="profile-name" id="profileName">Member</div>
          <div class="profile-id" id="profileId">FWF-000000</div>
          <div class="profile-meta">
            <span><i class="fa-solid fa-phone"></i> <span id="profileMobile">‚Äî</span></span>
            <span><i class="fa-solid fa-envelope"></i> <span id="profileEmail">‚Äî</span></span>
            <span><i class="fa-solid fa-calendar"></i> Joined <span id="profileJoined">‚Äî</span></span>
          </div>
        </div>
      </div>

      <div class="grid-2">
        <div>
          <h3 style="font-size:15px;font-weight:800;margin-bottom:12px"><i class="fa-solid fa-circle-check" style="color:var(--success)"></i> Membership Status</h3>
          <div class="stat-card" style="margin-bottom:12px">
            <div class="s-label">Status</div>
            <div id="profileStatus" style="font-weight:800;font-size:16px;color:var(--success)">Active</div>
          </div>
        </div>
        <div>
          <h3 style="font-size:15px;font-weight:800;margin-bottom:12px"><i class="fa-solid fa-pen" style="color:var(--accent)"></i> Update Profile</h3>
          <div class="form-group">
            <label>Display Name</label>
            <input type="text" class="form-input" id="editName" placeholder="Your name">
          </div>
          <div class="form-group">
            <label>Bio</label>
            <textarea class="form-input" id="editBio" placeholder="Tell us about yourself..." rows="3"></textarea>
          </div>
          <button class="btn btn-primary" id="saveProfileBtn"><i class="fa-solid fa-save"></i> Save Profile</button>
        </div>
      </div>
    </div>

    <!-- ID Card -->
    <div class="content-card">
      <h3><i class="fa-solid fa-id-card"></i> Digital Member ID Card</h3>
      <div style="max-width:400px;margin:0 auto">
        <div style="background:linear-gradient(135deg,#0f172a,#1e293b);border-radius:16px;padding:24px;color:#fff;position:relative;overflow:hidden">
          <div style="position:absolute;right:-20px;top:-20px;width:120px;height:120px;border-radius:50%;background:rgba(99,102,241,.2)"></div>
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px">
            <img src="assets/images/logo.png" alt="FWF" style="width:40px;height:40px;border-radius:8px">
            <div>
              <div style="font-size:16px;font-weight:900">Foundris Welfare Foundation</div>
              <div style="font-size:10px;opacity:.7;font-weight:600">Member Identity Card</div>
            </div>
          </div>
          <div style="font-size:22px;font-weight:900;margin-bottom:4px" id="cardName">Member Name</div>
          <div style="font-size:14px;font-weight:700;color:#818cf8;margin-bottom:16px" id="cardId">FWF-000000</div>
          <div style="display:flex;gap:20px;font-size:11px;opacity:.7;font-weight:600">
            <span><i class="fa-solid fa-phone"></i> <span id="cardMobile">‚Äî</span></span>
            <span><i class="fa-solid fa-calendar"></i> <span id="cardJoined">‚Äî</span></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== SOCIAL WORK FEED ===================== -->
  <div class="page" id="page-feed">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <h3 style="font-size:16px;font-weight:800"><i class="fa-solid fa-camera" style="color:var(--accent)"></i> Social Work Feed</h3>
      <button class="btn btn-primary" onclick="openModal('postModal')"><i class="fa-solid fa-plus"></i> New Post</button>
    </div>

    <div id="feedContainer">
      <!-- Sample Feed Posts -->
      <div class="feed-card">
        <div class="feed-header">
          <div class="feed-avatar">FW</div>
          <div>
            <div class="feed-name">FWF Community</div>
            <div class="feed-time">Today ‚Ä¢ Welfare Activity</div>
          </div>
        </div>
        <div class="feed-body">
          üå± Tree plantation drive completed! 50 trees planted by our members in collaboration with local schools. 
          Together, we're building a greener future.
        </div>
        <div class="feed-actions">
          <button><i class="fa-regular fa-heart"></i> 24</button>
          <button><i class="fa-regular fa-comment"></i> 8</button>
          <button><i class="fa-solid fa-share"></i> Share</button>
        </div>
      </div>

      <div class="feed-card">
        <div class="feed-header">
          <div class="feed-avatar" style="background:linear-gradient(135deg,#22c55e,#059669)">SK</div>
          <div>
            <div class="feed-name">Skill Development Camp</div>
            <div class="feed-time">Yesterday ‚Ä¢ Training</div>
          </div>
        </div>
        <div class="feed-body">
          üé® Free tailoring workshop for 30 women completed! Our members are learning and earning. 
          Next batch starts soon ‚Äî refer friends to join!
        </div>
        <div class="feed-actions">
          <button><i class="fa-regular fa-heart"></i> 42</button>
          <button><i class="fa-regular fa-comment"></i> 15</button>
          <button><i class="fa-solid fa-share"></i> Share</button>
        </div>
      </div>

      <div class="feed-card">
        <div class="feed-header">
          <div class="feed-avatar" style="background:linear-gradient(135deg,#f59e0b,#d97706)">HC</div>
          <div>
            <div class="feed-name">Health Camp</div>
            <div class="feed-time">3 days ago ‚Ä¢ Health</div>
          </div>
        </div>
        <div class="feed-body">
          üè• Free health checkup camp organized for 100+ women in rural area. Eye testing, blood pressure 
          screening & nutrition counseling provided.
        </div>
        <div class="feed-actions">
          <button><i class="fa-regular fa-heart"></i> 67</button>
          <button><i class="fa-regular fa-comment"></i> 22</button>
          <button><i class="fa-solid fa-share"></i> Share</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== TRAINING & COURSES ===================== -->
  <div class="page" id="page-training">
    <div class="tab-bar">
      <button class="tab-btn active" data-tab="available-courses">Available Courses</button>
      <button class="tab-btn" data-tab="my-courses">My Courses</button>
      <button class="tab-btn" data-tab="certificates">Certificates</button>
    </div>

    <div class="tab-content active" id="available-courses">
      <div class="grid-3">
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#6366f1,#8b5cf6)"><i class="fa-solid fa-scissors"></i></div>
          <div class="course-info">
            <h4>Tailoring & Stitching</h4>
            <p>Learn complete tailoring from basic to advanced level</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 4 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#22c55e,#059669)"><i class="fa-solid fa-laptop-code"></i></div>
          <div class="course-info">
            <h4>Basic Computer Skills</h4>
            <p>MS Office, Internet, Email & Digital basics</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 6 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#f59e0b,#d97706)"><i class="fa-solid fa-utensils"></i></div>
          <div class="course-info">
            <h4>Food Processing & Packaging</h4>
            <p>Start your own food business from home</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 3 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#ec4899,#be185d)"><i class="fa-solid fa-palette"></i></div>
          <div class="course-info">
            <h4>Handicraft & Mehndi Art</h4>
            <p>Traditional & modern designs for business</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 3 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#06b6d4,#0891b2)"><i class="fa-solid fa-chart-bar"></i></div>
          <div class="course-info">
            <h4>Digital Marketing</h4>
            <p>Social media, SEO & online business skills</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 5 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
        <div class="course-card">
          <div class="course-thumb" style="background:linear-gradient(135deg,#14b8a6,#0d9488)"><i class="fa-solid fa-seedling"></i></div>
          <div class="course-info">
            <h4>Organic Farming</h4>
            <p>Kitchen garden & organic produce business</p>
            <div class="course-status">
              <span style="color:var(--success)"><i class="fa-solid fa-clock"></i> 4 Weeks</span>
              <span class="badge b-active">Free</span>
            </div>
            <button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%;justify-content:center">Enroll Now</button>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="my-courses">
      <div class="content-card">
        <div class="empty-state">
          <i class="fa-solid fa-graduation-cap"></i>
          <p>You haven't enrolled in any course yet. Start learning today!</p>
          <button class="btn btn-primary" style="margin-top:12px" onclick="document.querySelector('[data-tab=available-courses]').click()">Browse Courses</button>
        </div>
      </div>
    </div>

    <div class="tab-content" id="certificates">
      <div class="content-card">
        <div class="empty-state">
          <i class="fa-solid fa-certificate"></i>
          <p>Complete a course to earn your certificate!</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== WALLET ===================== -->
  <div class="page" id="page-wallet">
    <!-- Wallet Overview Stats -->
    <div class="stats-row" style="margin-bottom:20px">
      <div class="stat-card">
        <div class="s-icon s-purple"><i class="fa-solid fa-star"></i></div>
        <div class="s-label">Total Points</div>
        <div class="s-value" id="walletTotalPoints">0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-green"><i class="fa-solid fa-wallet"></i></div>
        <div class="s-label">Wallet Balance</div>
        <div class="s-value" id="walletBalance">‚Çπ0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-blue"><i class="fa-solid fa-user-plus"></i></div>
        <div class="s-label">Total Referrals</div>
        <div class="s-value" id="walletReferrals">0</div>
      </div>
      <div class="stat-card">
        <div class="s-icon s-amber"><i class="fa-solid fa-hand-holding-heart"></i></div>
        <div class="s-label">Donations Earned</div>
        <div class="s-value" id="walletDonations">‚Çπ0</div>
      </div>
    </div>

    <!-- Wallet Tabs -->
    <div style="display:flex;gap:8px;margin-bottom:20px;border-bottom:2px solid var(--card-border);padding-bottom:2px;overflow-x:auto;flex-wrap:wrap">
      <button class="wallet-tab active" data-tab="activity"><i class="fa-solid fa-list"></i> My Activity</button>
      <button class="wallet-tab" data-tab="referrals"><i class="fa-solid fa-user-plus"></i> Referrals & Earnings</button>
      <button class="wallet-tab" data-tab="points"><i class="fa-solid fa-star"></i> Points</button>
    </div>

    <!-- Tab Content -->
    <!-- My Activity Section -->
    <div class="wallet-section active" id="wallet-activity">
      <h3 style=\"font-size:18px;font-weight:900\"><i class=\"fa-solid fa-list\" style=\"color:var(--accent)\"></i> My Activity</h3>
      
      <div class="grid-2">
        <!-- Membership Fees -->
        <div class="content-card">
          <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-credit-card" style="color:var(--info)"></i> Membership Fees & Invoices</h4>
          <div class="table-wrap">
            <table class="data-table">
              <thead><tr><th>Date</th><th>Amount</th><th>Status</th><th>Invoice</th></tr></thead>
              <tbody id="membershipFeesBody">
                <tr><td colspan="4" class="empty-state"><p>No records yet</p></td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Donation History -->
        <div class="content-card">
          <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-hand-holding-heart" style="color:var(--success)"></i> My Donation History</h4>
          <div class="table-wrap">
            <table class="data-table">
              <thead><tr><th>Donor</th><th>Amount</th><th>Points</th><th>Date</th></tr></thead>
              <tbody id="myDonationsBody">
                <tr><td colspan="4" class="empty-state"><p>No donations yet</p></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Quiz Participation -->
      <div class="content-card" style="margin-top:16px">
        <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-ticket" style="color:var(--warning)"></i> Quiz Ticket Sales</h4>
        <div class="table-wrap">
          <table class="data-table">
            <thead><tr><th>Buyer</th><th>Contact</th><th>Price</th><th>Points Earned</th><th>Date</th></tr></thead>
            <tbody id="quizTicketsBody">
              <tr><td colspan="5" class="empty-state"><p>No quiz tickets sold yet</p></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Referrals & Earnings Section -->
    <div class="wallet-section" id="wallet-referrals" style="display:none">
      <h3 style=\"font-size:18px;font-weight:900\"><i class=\"fa-solid fa-user-plus\" style=\"color:var(--accent)\"></i> Referrals & Earnings</h3>
      
      <!-- Referral Code -->
      <div class="content-card" style="margin-bottom:16px">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px">
          <div>
            <h4 style="margin-bottom:4px;font-size:14px"><i class="fa-solid fa-link"></i> Your Referral Code</h4>
            <p style="font-size:12px;color:var(--text-muted)">Share with friends to earn 250 points when they join!</p>
          </div>
          <div style="display:flex;gap:10px;align-items:center">
            <input type="text" class="form-input" id="refCode" readonly style="font-weight:900;font-size:16px;text-align:center;max-width:200px">
            <button class="btn btn-ghost" onclick="copyRefCode()"><i class="fa-solid fa-copy"></i></button>
          </div>
        </div>
      </div>

      <div class="grid-2">
        <!-- Add Member -->
        <div class="content-card">
          <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-user-plus" style="color:var(--accent)"></i> Add New Member</h4>
          <p style="font-size:12px;color:var(--text-muted);margin-bottom:14px">Refer a new member and earn 250 points on successful payment!</p>
          <div class="form-group">
            <label>Member Name</label>
            <input type="text" class="form-input" id="newMemberName" placeholder="Full name">
          </div>
          <div class="form-group">
            <label>Mobile Number</label>
            <input type="tel" class="form-input" id="newMemberMobile" placeholder="10-digit mobile">
          </div>
          <div class="form-group">
            <label>Payment Amount (‚Çπ)</label>
            <input type="number" class="form-input" id="newMemberAmount" placeholder="500" value="500">
          </div>
          <button class="btn btn-success" id="addMemberBtn"><i class="fa-solid fa-plus"></i> Add Member</button>
        </div>

        <!-- Add Supporter/Volunteer -->
        <div class="content-card">
          <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-hands-helping" style="color:var(--success)"></i> Add Supporter (Volunteer)</h4>
          <p style="font-size:12px;color:var(--text-muted);margin-bottom:14px">Add a volunteer supporter!</p>
          <div class="form-group">
            <label>Supporter Name</label>
            <input type="text" class="form-input" id="supporterName" placeholder="Full name">
          </div>
          <div class="form-group">
            <label>Contact</label>
            <input type="text" class="form-input" id="supporterContact" placeholder="Phone/Email">
          </div>
          <div class="form-group">
            <label>Role</label>
            <input type="text" class="form-input" id="supporterRole" placeholder="Volunteer role">
          </div>
          <button class="btn btn-success" id="addSupporterBtn"><i class="fa-solid fa-plus"></i> Add Supporter</button>
        </div>
      </div>

      <!-- Record Donation -->
      <div class="content-card" style="margin-top:16px">
        <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-hand-holding-heart" style="color:var(--accent2)"></i> Record Donation</h4>
        <p style="font-size:12px;color:var(--text-muted);margin-bottom:14px">Collected a donation? Record it to earn 10% as reward points!</p>
        <div class="grid-3">
          <div class="form-group">
            <label>Donation Amount (‚Çπ)</label>
            <input type="number" class="form-input" id="donAmount" placeholder="e.g. 500" min="1">
          </div>
          <div class="form-group">
            <label>Donor Name</label>
            <input type="text" class="form-input" id="donName" placeholder="Donor name">
          </div>
          <div class="form-group">
            <label>Donor Contact</label>
            <input type="text" class="form-input" id="donContact" placeholder="Phone/Email">
          </div>
        </div>
        <button class="btn btn-success" id="recordDonBtn" style="margin-top:10px"><i class="fa-solid fa-plus"></i> Record Donation</button>
      </div>

      <!-- Sell Quiz Ticket -->
      <div class="content-card" style="margin-top:16px">
        <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-ticket" style="color:var(--warning)"></i> Sell Quiz Ticket</h4>
        <p style="font-size:12px;color:var(--text-muted);margin-bottom:14px">Sold a quiz ticket? Record it and process payment to earn 10% points!</p>
        <div class="grid-3">
          <div class="form-group">
            <label>Buyer Name</label>
            <input type="text" class="form-input" id="tickBuyer" placeholder="Buyer name">
          </div>
          <div class="form-group">
            <label>Buyer Contact</label>
            <input type="text" class="form-input" id="tickContact" placeholder="Phone/Email">
          </div>
          <div class="form-group">
            <label>Ticket Price (‚Çπ)</label>
            <input type="number" class="form-input" id="tickPrice" placeholder="100" value="100" min="1">
          </div>
        </div>
        <button class="btn btn-success" id="sellTicketBtn" style="margin-top:10px"><i class="fa-solid fa-plus"></i> Record Ticket Sale</button>
      </div>

      <!-- Referral Tracking Table -->
      <div class="content-card" style="margin-top:16px">
        <h4 style="margin-bottom:12px;font-size:14px"><i class="fa-solid fa-list"></i> My Referrals</h4>
        <div class="table-wrap">
          <table class="data-table">
            <thead><tr><th>Name</th><th>Member ID</th><th>Amount</th><th>Points</th><th>Status</th><th>Date</th></tr></thead>
            <tbody id="referralsBody">
              <tr><td colspan="6" class="empty-state"><p>No referrals yet</p></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Points Section -->
    <div class="wallet-section" id="wallet-points" style="display:none">
      <h3 style="margin-bottom:16px;font-size:18px;font-weight:900"><i class="fa-solid fa-star" style="color:var(--accent)"></i> Points Management</h3>
      
      <!-- Points Breakdown -->
      <div class="stats-row" style="margin-bottom:20px">
        <div class="stat-card">
          <div class="s-icon s-purple"><i class="fa-solid fa-star"></i></div>
          <div class="s-label">Total Points</div>
          <div class="s-value" id="wPoints">0</div>
        </div>
        <div class="stat-card">
          <div class="s-icon s-green"><i class="fa-solid fa-hand-holding-heart"></i></div>
          <div class="s-label">From Donations</div>
          <div class="s-value" id="wDonPts">0</div>
        </div>
        <div class="stat-card">
          <div class="s-icon s-blue"><i class="fa-solid fa-user-plus"></i></div>
          <div class="s-label">From Referrals</div>
          <div class="s-value" id="wRefPts">0</div>
        </div>
        <div class="stat-card">
          <div class="s-icon s-amber"><i class="fa-solid fa-ticket"></i></div>
          <div class="s-label">From Quiz Tickets</div>
          <div class="s-value" id="wQuizPts">0</div>
        </div>
      </div>

      <div class="grid-2">
        <!-- Redeem Action Card -->
        <div class="content-card" style="background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;border:none">
          <div style="display:flex;flex-direction:column;gap:12px;align-items:center;text-align:center;padding:20px">
            <div style="width:60px;height:60px;border-radius:50%;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:28px">
              <i class="fa-solid fa-gift"></i>
            </div>
            <h4 style="margin:0;font-size:18px;font-weight:900">Redeem Points</h4>
            <p style="font-size:13px;opacity:.9;margin:0">Convert your points to support social causes and make a difference</p>
            <button class="btn" onclick="openRedeemModal()" style="background:#fff;color:var(--accent);font-weight:800;margin-top:8px">
              <i class="fa-solid fa-arrow-right"></i> Start Redeeming
            </button>
          </div>
        </div>

        <!-- Points Summary -->
        <div class="content-card">
          <h4 style="margin-bottom:12px;font-size:14px;font-weight:800"><i class="fa-solid fa-chart-pie"></i> Points Summary</h4>
          <div style="display:flex;flex-direction:column;gap:10px">
            <div style="display:flex;justify-content:space-between;align-items:center;padding:10px;background:var(--bg-1);border-radius:8px">
              <span style="font-size:12px;font-weight:700;color:var(--text-secondary)"><i class="fa-solid fa-hand-holding-heart" style="color:var(--success)"></i> Donations</span>
              <span style="font-weight:900;color:var(--success)" id="pointsDonSummary">0 pts</span>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;padding:10px;background:var(--bg-1);border-radius:8px">
              <span style="font-size:12px;font-weight:700;color:var(--text-secondary)"><i class="fa-solid fa-user-plus" style="color:var(--info)"></i> Referrals</span>
              <span style="font-weight:900;color:var(--info)" id="pointsRefSummary">0 pts</span>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;padding:10px;background:var(--bg-1);border-radius:8px">
              <span style="font-size:12px;font-weight:700;color:var(--text-secondary)"><i class="fa-solid fa-ticket" style="color:var(--warning)"></i> Quiz Tickets</span>
              <span style="font-weight:900;color:var(--warning)" id="pointsQuizSummary">0 pts</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Points History -->
      <div class="content-card" style="margin-top:16px">
        <h4 style="margin-bottom:12px;font-size:14px;font-weight:800"><i class="fa-solid fa-clock-rotate-left"></i> Points History</h4>
        <div class="table-wrap">
          <table class="data-table">
            <thead><tr><th>Type</th><th>Points</th><th>Description</th><th>Date</th></tr></thead>
            <tbody id="pointsHistoryBody">
              <tr><td colspan="4" class="empty-state"><p>No points earned yet</p></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== REDEEM POINTS MODAL ===================== -->
  <div class="modal" id="redeemModal">
    <div class="modal-content" style="max-width:600px">
      <div class="modal-header">
        <h3><i class="fa-solid fa-gift"></i> Redeem Points for Social Cause</h3>
        <button class="modal-close" onclick="closeModal('redeemModal')">&times;</button>
      </div>
      <div class="modal-body">
        <div style="background:var(--accent-soft);padding:14px;border-radius:10px;margin-bottom:16px;text-align:center">
          <div style="font-size:12px;color:var(--text-muted);font-weight:700">Available Points</div>
          <div style="font-size:32px;font-weight:900;color:var(--accent)" id="availPointsDisplay">0</div>
        </div>

        <div class="form-group">
          <label>Points to Redeem</label>
          <input type="number" class="form-input" id="redeemPointsInput" placeholder="Enter points" min="1">
        </div>

        <div class="form-group">
          <label>Social Cause</label>
          <select class="form-input" id="socialCauseSelect">
            <option value="">Select a cause</option>
            <option value="Scholarship">Scholarship Program</option>
            <option value="Tree Plantation">Tree Plantation Drive</option>
            <option value="Food Distribution">Food Distribution</option>
            <option value="Health Camp">Health Camp Support</option>
            <option value="Women Empowerment">Women Empowerment Fund</option>
            <option value="Clean Water">Clean Water Initiative</option>
          </select>
        </div>

        <div class="form-group">
          <label>Payment Method</label>
          <div style="display:flex;gap:16px;margin-top:8px">
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
              <input type="radio" name="paymentMethod" value="bank" id="bankRadio" checked>
              <span>Bank Account</span>
            </label>
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
              <input type="radio" name="paymentMethod" value="upi" id="upiRadio">
              <span>UPI</span>
            </label>
          </div>
        </div>

        <!-- Bank Details Section -->
        <div id="bankDetailsSection">
          <div class="form-row">
            <div class="form-group">
              <label>Account Number</label>
              <input type="text" class="form-input" id="accNumber1" placeholder="Account number">
            </div>
            <div class="form-group">
              <label>Confirm Account Number</label>
              <input type="text" class="form-input" id="accNumber2" placeholder="Re-enter account">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>IFSC Code</label>
              <input type="text" class="form-input" id="ifscCode" placeholder="IFSC code">
            </div>
            <div class="form-group">
              <label>Bank Name</label>
              <input type="text" class="form-input" id="bankName" placeholder="Bank name">
            </div>
          </div>
          <div class="form-group">
            <label>Account Holder Name</label>
            <input type="text" class="form-input" id="accHolder" placeholder="As per bank records">
          </div>
        </div>

        <!-- UPI Section -->
        <div id="upiDetailsSection" style="display:none">
          <div class="form-group">
            <label>UPI ID</label>
            <input type="text" class="form-input" id="upiId" placeholder="yourname@paytm">
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn btn-ghost" onclick="closeModal('redeemModal')">Cancel</button>
        <button class="btn btn-success" id="submitRedeemBtn" onclick="submitRedeemRequest()"><i class="fa-solid fa-check"></i> Submit Request</button>
      </div>
    </div>

  </div>

  <!-- ===================== MARKETPLACE ===================== -->
  <div class="page" id="page-marketplace">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <h3 style="font-size:16px;font-weight:800"><i class="fa-solid fa-store" style="color:var(--accent)"></i> Member Marketplace</h3>
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <input type="text" class="form-input" id="marketSearch" placeholder="Search products..." style="max-width:200px;padding:8px 12px;font-size:13px">
        <select class="form-input" id="marketCatFilter" style="max-width:180px;padding:8px 12px;font-size:13px" onchange="loadMarketProducts()">
          <option value="">All Categories</option>
        </select>
        <select class="form-input" id="marketSort" style="max-width:160px;padding:8px 12px;font-size:13px" onchange="loadMarketProducts()">
          <option value="">Featured</option>
          <option value="newest">Newest</option>
          <option value="price-low">Price: Low ‚Üí High</option>
          <option value="price-high">Price: High ‚Üí Low</option>
          <option value="popular">Most Popular</option>
        </select>
        <a href="store.html" class="btn btn-primary btn-sm" target="_blank"><i class="fa-solid fa-external-link"></i> Full Store</a>
      </div>
    </div>
    <div class="grid-3" id="marketGrid">
      <div class="empty-state"><i class="fa-solid fa-spinner fa-spin"></i><p>Loading products...</p></div>
    </div>
    <div id="marketPagination" style="display:flex;justify-content:center;gap:6px;margin-top:16px"></div>
  </div>

  <!-- ===================== SELLER PANEL ===================== -->
  <div class="page" id="page-seller">
    <div class="stats-row" style="grid-template-columns:repeat(4,1fr)">
      <div class="stat-card">
        <div class="seller-stat">
          <div class="val" id="selProducts">0</div>
          <div class="lbl">Products</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="seller-stat">
          <div class="val" id="selApproved">0</div>
          <div class="lbl">Approved</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="seller-stat">
          <div class="val" id="selOrders">0</div>
          <div class="lbl">Total Orders</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="seller-stat">
          <div class="val" id="selEarnings">‚Çπ0</div>
          <div class="lbl">Earnings</div>
        </div>
      </div>
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <h3 style="font-size:16px;font-weight:800"><i class="fa-solid fa-boxes-stacked" style="color:var(--accent)"></i> Your Products</h3>
      <button class="btn btn-primary" onclick="openModal('addProductModal')"><i class="fa-solid fa-plus"></i> Add Product</button>
    </div>

    <div class="content-card" id="sellerProductsList">
      <div class="empty-state">
        <i class="fa-solid fa-spinner fa-spin"></i>
        <p>Loading your products...</p>
      </div>
    </div>

    <div class="content-card" style="margin-top:18px">
      <h3 style="margin-bottom:12px"><i class="fa-solid fa-receipt"></i> Recent Orders</h3>
      <div class="table-wrap">
        <table class="data-table">
          <thead><tr><th>Order ID</th><th>Product</th><th>Buyer</th><th>Qty</th><th>Amount</th><th>Status</th><th>Date</th></tr></thead>
          <tbody id="sellerOrdersBody">
            <tr><td colspan="7" class="empty-state"><i class="fa-solid fa-spinner fa-spin"></i><p>Loading...</p></td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ===================== EVENTS & ACTIVITIES ===================== -->
  <div class="page" id="page-events">
    <div class="tab-bar">
      <button class="tab-btn active" data-tab="upcoming-events">Upcoming Events</button>
      <button class="tab-btn" data-tab="volunteer-tab">Volunteer</button>
      <button class="tab-btn" data-tab="my-events">My Registrations</button>
    </div>

    <div class="tab-content active" id="upcoming-events">
      <div class="event-card">
        <div class="event-date">
          <div class="day">15</div>
          <div class="month">Mar</div>
        </div>
        <div class="event-info" style="flex:1">
          <h4>Women's Day Skill Festival</h4>
          <p><i class="fa-solid fa-location-dot"></i> Community Center, Kanpur &bull; 10:00 AM</p>
        </div>
        <button class="btn btn-primary btn-sm">Register</button>
      </div>
      <div class="event-card">
        <div class="event-date" style="background:linear-gradient(135deg,#22c55e,#059669)">
          <div class="day">22</div>
          <div class="month">Mar</div>
        </div>
        <div class="event-info" style="flex:1">
          <h4>Tree Plantation Drive</h4>
          <p><i class="fa-solid fa-location-dot"></i> City Park, Lucknow &bull; 7:00 AM</p>
        </div>
        <button class="btn btn-primary btn-sm">Register</button>
      </div>
      <div class="event-card">
        <div class="event-date" style="background:linear-gradient(135deg,#f59e0b,#d97706)">
          <div class="day">05</div>
          <div class="month">Apr</div>
        </div>
        <div class="event-info" style="flex:1">
          <h4>Handicraft Exhibition & Sale</h4>
          <p><i class="fa-solid fa-location-dot"></i> Town Hall, Varanasi &bull; 11:00 AM</p>
        </div>
        <button class="btn btn-primary btn-sm">Register</button>
      </div>
      <div class="event-card">
        <div class="event-date" style="background:linear-gradient(135deg,#ec4899,#be185d)">
          <div class="day">12</div>
          <div class="month">Apr</div>
        </div>
        <div class="event-info" style="flex:1">
          <h4>Free Health Camp for Women</h4>
          <p><i class="fa-solid fa-location-dot"></i> PHC Center, Kanpur &bull; 9:00 AM</p>
        </div>
        <button class="btn btn-primary btn-sm">Register</button>
      </div>
    </div>

    <div class="tab-content" id="volunteer-tab">
      <div class="content-card">
        <h3><i class="fa-solid fa-hands-helping"></i> Volunteer Opportunities</h3>
        <p style="color:var(--text-muted);font-size:13px;margin-bottom:16px">Join as a volunteer and earn extra reward points!</p>
        <div class="grid-2">
          <div class="event-card" style="margin-bottom:0">
            <div class="event-date" style="background:linear-gradient(135deg,#06b6d4,#0891b2);width:44px;height:44px">
              <div class="day" style="font-size:16px"><i class="fa-solid fa-chalkboard-teacher"></i></div>
            </div>
            <div class="event-info">
              <h4>Teaching Assistant</h4>
              <p>Help in skill training camps</p>
            </div>
          </div>
          <div class="event-card" style="margin-bottom:0">
            <div class="event-date" style="background:linear-gradient(135deg,#14b8a6,#0d9488);width:44px;height:44px">
              <div class="day" style="font-size:16px"><i class="fa-solid fa-hands-holding-child"></i></div>
            </div>
            <div class="event-info">
              <h4>Community Outreach</h4>
              <p>Door-to-door awareness programs</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="my-events">
      <div class="content-card">
        <div class="empty-state">
          <i class="fa-solid fa-calendar-check"></i>
          <p>No event registrations yet</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== HELP & SUPPORT ===================== -->
  <div class="page" id="page-support">
    <div class="grid-2">
      <div>
        <div class="content-card">
          <h3><i class="fa-solid fa-ticket"></i> Submit Support Ticket</h3>
          <div class="form-group">
            <label>Category</label>
            <select class="form-input" id="supCategory">
              <option value="general">General</option>
              <option value="technical">Technical</option>
              <option value="payment">Payment</option>
              <option value="membership">Membership</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label>Subject</label>
            <input type="text" class="form-input" id="supSubject" placeholder="Brief subject">
          </div>
          <div class="form-group">
            <label>Message</label>
            <textarea class="form-input" id="supMessage" placeholder="Describe your issue in detail..." rows="4"></textarea>
          </div>
          <button class="btn btn-primary" id="submitTicketBtn"><i class="fa-solid fa-paper-plane"></i> Submit Ticket</button>
        </div>

        <div class="content-card">
          <h3><i class="fa-solid fa-circle-question"></i> Quick Help</h3>
          <div style="display:flex;flex-direction:column;gap:8px">
            <a href="https://wa.me/919580118412" target="_blank" class="btn btn-success" style="justify-content:center"><i class="fa-brands fa-whatsapp"></i> WhatsApp Support</a>
            <a href="mailto:info@fwfindia.org" class="btn btn-ghost" style="justify-content:center"><i class="fa-solid fa-envelope"></i> Email Support</a>
          </div>
        </div>

        <div class="content-card">
          <h3><i class="fa-solid fa-message"></i> FAQ</h3>
          <details style="margin-bottom:8px">
            <summary style="font-weight:700;font-size:13px;cursor:pointer;padding:8px 0">How do I earn reward points?</summary>
            <p style="font-size:12px;color:var(--text-muted);padding:8px 0 8px 16px">Earn points through referrals (50% of joining fee), donation collection (10%), quiz ticket selling (10%), and volunteer participation.</p>
          </details>
          <details style="margin-bottom:8px">
            <summary style="font-weight:700;font-size:13px;cursor:pointer;padding:8px 0">How can I redeem my points?</summary>
            <p style="font-size:12px;color:var(--text-muted);padding:8px 0 8px 16px">Go to the "Redeem Points" section and support NGO projects like education kits, health camps, and more.</p>
          </details>
          <details style="margin-bottom:8px">
            <summary style="font-weight:700;font-size:13px;cursor:pointer;padding:8px 0">How does the Marketplace work?</summary>
            <p style="font-size:12px;color:var(--text-muted);padding:8px 0 8px 16px">Members can list handmade/local products for sale. Other members and public users can purchase. Go to Seller Panel to start selling.</p>
          </details>
          <details>
            <summary style="font-weight:700;font-size:13px;cursor:pointer;padding:8px 0">How do I renew my membership?</summary>
            <p style="font-size:12px;color:var(--text-muted);padding:8px 0 8px 16px">Contact support via WhatsApp or email for membership renewal. Annual fee keeps your account active.</p>
          </details>
        </div>
      </div>

      <div>
        <div class="content-card">
          <h3><i class="fa-solid fa-list-check"></i> My Tickets</h3>
          <div class="table-wrap">
            <table class="data-table">
              <thead><tr><th>Ticket</th><th>Subject</th><th>Status</th><th>Reply</th><th>Date</th></tr></thead>
              <tbody id="myTicketsBody">
                <tr><td colspan="5" class="empty-state"><p>No tickets submitted</p></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- ======== MODALS ======== -->

<!-- New Post Modal -->
<div class="modal-overlay hidden" id="postModal">
  <div class="modal-card" style="max-width:540px">
    <div class="modal-head">
      <h3><i class="fa-solid fa-camera"></i> New Social Work Post</h3>
      <button class="modal-close" onclick="closeModal('postModal')">&times;</button>
    </div>
    <div class="form-group">
      <label>Activity Type</label>
      <select class="form-input" id="postType">
        <option value="welfare">Welfare Activity</option>
        <option value="training">Training Session</option>
        <option value="health">Health Camp</option>
        <option value="plantation">Plantation Drive</option>
        <option value="other">Other</option>
      </select>
    </div>
    <div class="form-group">
      <label>Description</label>
      <textarea class="form-input" id="postDesc" placeholder="Describe the activity..." rows="4"></textarea>
    </div>
    <div class="form-group">
      <label>Photo/Video Upload</label>
      <input type="file" class="form-input" id="postMedia" accept="image/*,video/*">
    </div>
    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeModal('postModal')">Cancel</button>
      <button class="btn btn-primary"><i class="fa-solid fa-paper-plane"></i> Post</button>
    </div>
  </div>
</div>

<!-- Add Product Modal (Rich Flipkart/Amazon style) -->
<div class="modal-overlay hidden" id="addProductModal">
  <div class="modal-card" style="max-width:680px;max-height:90vh;overflow-y:auto">
    <div class="modal-head">
      <h3><i class="fa-solid fa-box-open"></i> Add Product</h3>
      <button class="modal-close" onclick="closeModal('addProductModal')">&times;</button>
    </div>

    <!-- STEP 1: Basic Info -->
    <div style="background:var(--bg-soft);border-radius:10px;padding:14px;margin-bottom:14px">
      <h4 style="font-size:13px;font-weight:800;color:var(--accent);margin:0 0 10px"><i class="fa-solid fa-info-circle"></i> Basic Information</h4>
      <div class="form-group">
        <label>Product Title *</label>
        <input type="text" class="form-input" id="prodTitle" placeholder="e.g. Handmade Madhubani Painting - Large Frame">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Category *</label>
          <select class="form-input" id="prodCat" onchange="loadSubcategories()">
            <option value="">Select Category</option>
          </select>
        </div>
        <div class="form-group">
          <label>Sub-Category</label>
          <select class="form-input" id="prodSubCat">
            <option value="">Select Sub-Category</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label>Brand / Maker Name</label>
        <input type="text" class="form-input" id="prodBrand" placeholder="e.g. FWF Artisans, Your Brand Name">
      </div>
    </div>

    <!-- STEP 2: Pricing -->
    <div style="background:var(--bg-soft);border-radius:10px;padding:14px;margin-bottom:14px">
      <h4 style="font-size:13px;font-weight:800;color:var(--accent);margin:0 0 10px"><i class="fa-solid fa-indian-rupee-sign"></i> Pricing & Stock</h4>
      <div class="form-row">
        <div class="form-group">
          <label>Selling Price (‚Çπ) *</label>
          <input type="number" class="form-input" id="prodPrice" placeholder="0" min="1">
        </div>
        <div class="form-group">
          <label>MRP (‚Çπ) <small style="color:var(--text-muted)">(Original price)</small></label>
          <input type="number" class="form-input" id="prodMRP" placeholder="0" min="0">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Stock Quantity</label>
          <input type="number" class="form-input" id="prodStock" placeholder="1" min="1" value="1">
        </div>
        <div class="form-group">
          <label>Unit</label>
          <select class="form-input" id="prodUnit">
            <option value="piece">Piece</option>
            <option value="kg">Kg</option>
            <option value="gram">Gram</option>
            <option value="litre">Litre</option>
            <option value="ml">ml</option>
            <option value="pack">Pack</option>
            <option value="set">Set</option>
            <option value="pair">Pair</option>
            <option value="box">Box</option>
            <option value="dozen">Dozen</option>
          </select>
        </div>
      </div>
    </div>

    <!-- STEP 3: Details -->
    <div style="background:var(--bg-soft);border-radius:10px;padding:14px;margin-bottom:14px">
      <h4 style="font-size:13px;font-weight:800;color:var(--accent);margin:0 0 10px"><i class="fa-solid fa-list-check"></i> Product Details</h4>
      <div class="form-group">
        <label>Description</label>
        <textarea class="form-input" id="prodDesc" placeholder="Describe your product in detail ‚Äî material, usage, care instructions..." rows="3"></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Condition</label>
          <select class="form-input" id="prodCondition">
            <option value="new">New</option>
            <option value="like-new">Like New</option>
            <option value="used">Used</option>
            <option value="refurbished">Refurbished</option>
          </select>
        </div>
        <div class="form-group">
          <label>Weight</label>
          <input type="text" class="form-input" id="prodWeight" placeholder="e.g. 500g, 1.2kg">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Material</label>
          <input type="text" class="form-input" id="prodMaterial" placeholder="e.g. Cotton, Wood, Silver">
        </div>
        <div class="form-group">
          <label>Color</label>
          <input type="text" class="form-input" id="prodColor" placeholder="e.g. Red, Multi-color">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Size</label>
          <input type="text" class="form-input" id="prodSize" placeholder="e.g. Large, 12x18 inches">
        </div>
        <div class="form-group">
          <label>Tags <small style="color:var(--text-muted)">(comma sep)</small></label>
          <input type="text" class="form-input" id="prodTags" placeholder="e.g. handmade, organic, gift">
        </div>
      </div>
    </div>

    <!-- STEP 4: Images -->
    <div style="background:var(--bg-soft);border-radius:10px;padding:14px;margin-bottom:14px">
      <h4 style="font-size:13px;font-weight:800;color:var(--accent);margin:0 0 10px"><i class="fa-solid fa-images"></i> Product Images <small style="font-weight:600;color:var(--text-muted)">(Max 8 images, 5MB each ‚Äî JPG, PNG, WebP)</small></h4>
      <div style="border:2px dashed var(--border);border-radius:12px;padding:20px;text-align:center;cursor:pointer;transition:.2s;background:#fff" id="imageDropZone" onclick="document.getElementById('prodImages').click()" ondragover="event.preventDefault();this.style.borderColor='var(--accent)'" ondragleave="this.style.borderColor='var(--border)'" ondrop="handleImageDrop(event)">
        <i class="fa-solid fa-cloud-arrow-up" style="font-size:2rem;color:var(--accent);margin-bottom:8px;display:block"></i>
        <p style="font-size:13px;font-weight:700;margin:0">Click to upload or drag & drop images</p>
        <p style="font-size:11px;color:var(--text-muted);margin:4px 0 0">First image will be the thumbnail</p>
      </div>
      <input type="file" id="prodImages" accept="image/jpeg,image/png,image/webp,image/gif" multiple style="display:none" onchange="handleImageSelect(event)">
      <div id="imagePreviewGrid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px"></div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeModal('addProductModal')">Cancel</button>
      <button class="btn btn-primary" id="submitProductBtn" onclick="submitProduct()"><i class="fa-solid fa-rocket"></i> Submit for Approval</button>
    </div>
  </div>
</div>

<script src="assets/js/fwf.js"></script>
<script src="auth.js"></script>
<script>
/* ============================================
   NAVIGATION
   ============================================ */
const pageTitles = {
  home: '<i class="fa-solid fa-house"></i> Dashboard',
  profile: '<i class="fa-solid fa-id-card"></i> Profile & ID Card',
  feed: '<i class="fa-solid fa-camera"></i> Social Work Feed',
  training: '<i class="fa-solid fa-graduation-cap"></i> Training & Courses',
  wallet: '<i class="fa-solid fa-wallet"></i> Wallet',
  marketplace: '<i class="fa-solid fa-store"></i> Marketplace',
  seller: '<i class="fa-solid fa-boxes-stacked"></i> Seller Panel',
  events: '<i class="fa-solid fa-calendar-days"></i> Events & Activities',
  support: '<i class="fa-solid fa-headset"></i> Help & Support'
};

function switchPage(page){
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item[data-page]').forEach(n => n.classList.remove('active'));
  const el = document.getElementById('page-' + page);
  if(el) el.classList.add('active');
  const nav = document.querySelector('.nav-item[data-page="'+page+'"]');
  if(nav) nav.classList.add('active');
  document.getElementById('pageTitle').innerHTML = pageTitles[page] || page;
  closeMobile();

  // Lazy load data
  if(page === 'wallet') loadWallet();
  if(page === 'support') loadMyTickets();
  if(page === 'profile') loadProfile();
  if(page === 'marketplace') loadMarketProducts();
  if(page === 'seller') loadSellerData();
}

document.querySelectorAll('.nav-item[data-page]').forEach(btn => {
  btn.addEventListener('click', () => switchPage(btn.dataset.page));
});

// Mobile
document.getElementById('mobileToggle').addEventListener('click', () => {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('mobileOverlay').classList.toggle('show');
});
document.getElementById('mobileOverlay').addEventListener('click', closeMobile);
function closeMobile(){
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('mobileOverlay').classList.remove('show');
}

// Tabs
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const parent = btn.closest('.page');
    parent.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    parent.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById(btn.dataset.tab).classList.add('active');
  });
});

// Category filters (marketplace) - now handled by loadMarketProducts()
// Image upload for Seller panel
let selectedImages = [];

function handleImageSelect(e){
  addImages(Array.from(e.target.files));
}
function handleImageDrop(e){
  e.preventDefault();
  e.currentTarget.style.borderColor = 'var(--border)';
  addImages(Array.from(e.dataTransfer.files));
}
function addImages(files){
  const MAX = 8, MAX_SIZE = 5*1024*1024;
  const allowed = ['image/jpeg','image/png','image/webp','image/gif'];
  for(const f of files){
    if(selectedImages.length >= MAX){ notify(`Max ${MAX} images allowed`,'warning'); break; }
    if(!allowed.includes(f.type)){ notify(`${f.name}: Only JPG, PNG, WebP, GIF allowed`,'warning'); continue; }
    if(f.size > MAX_SIZE){ notify(`${f.name}: Max 5MB per image`,'warning'); continue; }
    selectedImages.push(f);
  }
  renderImagePreviews();
}
function renderImagePreviews(){
  const grid = document.getElementById('imagePreviewGrid');
  grid.innerHTML = selectedImages.map((f,i) => {
    const url = URL.createObjectURL(f);
    return `<div style="position:relative;aspect-ratio:1;border-radius:10px;overflow:hidden;border:2px solid ${i===0?'var(--accent)':'var(--border)'}">
      <img src="${url}" style="width:100%;height:100%;object-fit:cover"/>
      ${i===0?'<div style="position:absolute;top:4px;left:4px;background:var(--accent);color:#fff;font-size:9px;font-weight:800;padding:2px 6px;border-radius:6px">THUMB</div>':''}
      <button onclick="removeImage(${i})" style="position:absolute;top:4px;right:4px;width:22px;height:22px;border-radius:50%;background:rgba(0,0,0,.6);color:#fff;border:none;cursor:pointer;font-size:11px">&times;</button>
    </div>`;
  }).join('');
}
function removeImage(i){ selectedImages.splice(i,1); renderImagePreviews(); }

// Convert File to base64
function fileToBase64(file){
  return new Promise((resolve,reject)=>{
    const r = new FileReader();
    r.onload = () => resolve(r.result);
    r.onerror = reject;
    r.readAsDataURL(file);
  });
}

// Load categories for dropdowns
let storeCategories = {};
async function loadStoreCategories(){
  try{
    const r = await fetch('/api/store/categories');
    const d = await r.json();
    if(d.ok) storeCategories = d.categories;
  } catch(e){}
  // Populate Add Product category dropdown
  const sel = document.getElementById('prodCat');
  const filterSel = document.getElementById('marketCatFilter');
  sel.innerHTML = '<option value="">Select Category</option>';
  for(const [key,cat] of Object.entries(storeCategories)){
    sel.innerHTML += `<option value="${key}">${cat.label}</option>`;
    filterSel.innerHTML += `<option value="${key}">${cat.label}</option>`;
  }
}
function loadSubcategories(){
  const cat = document.getElementById('prodCat').value;
  const sub = document.getElementById('prodSubCat');
  sub.innerHTML = '<option value="">Select Sub-Category</option>';
  if(cat && storeCategories[cat] && storeCategories[cat].subs){
    storeCategories[cat].subs.forEach(s => {
      sub.innerHTML += `<option value="${s}">${s}</option>`;
    });
  }
}

// Submit product
async function submitProduct(){
  const title = document.getElementById('prodTitle').value.trim();
  const category = document.getElementById('prodCat').value;
  const price = parseFloat(document.getElementById('prodPrice').value);
  if(!title){ notify('Product title is required','warning'); return; }
  if(!category){ notify('Select a category','warning'); return; }
  if(!price || price <= 0){ notify('Enter a valid price','warning'); return; }

  const btn = document.getElementById('submitProductBtn');
  btn.disabled = true;
  btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Uploading...';

  try{
    // Convert images to base64
    const images = [];
    for(const f of selectedImages){
      const b64 = await fileToBase64(f);
      images.push(b64);
    }

    const body = {
      title,
      category,
      subcategory: document.getElementById('prodSubCat').value || null,
      brand: document.getElementById('prodBrand').value.trim() || null,
      price,
      mrp: parseFloat(document.getElementById('prodMRP').value) || null,
      stock: parseInt(document.getElementById('prodStock').value) || 1,
      unit: document.getElementById('prodUnit').value,
      description: document.getElementById('prodDesc').value.trim() || null,
      condition: document.getElementById('prodCondition').value,
      weight: document.getElementById('prodWeight').value.trim() || null,
      material: document.getElementById('prodMaterial').value.trim() || null,
      color: document.getElementById('prodColor').value.trim() || null,
      size: document.getElementById('prodSize').value.trim() || null,
      tags: document.getElementById('prodTags').value.trim() || null,
      images
    };

    const r = await AUTH.api('/api/member/add-product', { method:'POST', body });
    notify(r.message || 'Product submitted!', 'success');
    closeModal('addProductModal');
    // Reset form
    selectedImages = [];
    renderImagePreviews();
    document.querySelectorAll('#addProductModal input, #addProductModal textarea').forEach(el => el.value = '');
    document.querySelectorAll('#addProductModal select').forEach(el => el.selectedIndex = 0);
    loadSellerData();
  } catch(e){
    notify(e.message || 'Failed to submit product','error');
  } finally {
    btn.disabled = false;
    btn.innerHTML = '<i class="fa-solid fa-rocket"></i> Submit for Approval';
  }
}

// Load marketplace products (browse)
let marketPage = 1;
async function loadMarketProducts(){
  const grid = document.getElementById('marketGrid');
  grid.innerHTML = '<div class="empty-state"><i class="fa-solid fa-spinner fa-spin"></i><p>Loading...</p></div>';
  const params = new URLSearchParams();
  const cat = document.getElementById('marketCatFilter').value;
  if(cat) params.set('category', cat);
  const search = document.getElementById('marketSearch').value.trim();
  if(search) params.set('search', search);
  const sort = document.getElementById('marketSort').value;
  if(sort) params.set('sort', sort);
  params.set('page', marketPage);
  params.set('limit', 12);
  try{
    const r = await fetch('/api/store/products?' + params.toString());
    const d = await r.json();
    if(!d.ok || !d.products.length){
      grid.innerHTML = '<div class="empty-state"><i class="fa-solid fa-box-open"></i><p>No products found. Check back soon!</p></div>';
      document.getElementById('marketPagination').innerHTML = '';
      return;
    }
    grid.innerHTML = d.products.map(p => {
      const img = p.thumbnail || (p.images && p.images[0]);
      const catInfo = storeCategories[p.category];
      const catLabel = catInfo ? catInfo.label : p.category;
      return `<div class="product-card" style="cursor:pointer" onclick="window.open('store.html','_blank')">
        <div class="product-thumb" style="${img ? 'padding:0' : ''}">
          ${img ? `<img src="${img}" style="width:100%;height:100%;object-fit:cover;border-radius:10px 10px 0 0"/>` : `<i class="fa-solid fa-image"></i>`}
        </div>
        <div class="product-info">
          <div style="font-size:10px;font-weight:700;color:var(--accent);text-transform:uppercase;margin-bottom:2px">${catLabel}</div>
          <h4 style="font-size:13px;margin:0 0 4px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden">${p.title}</h4>
          <div class="seller" style="font-size:11px">By ${p.seller_name || 'FWF Seller'}</div>
          <div class="product-price" style="display:flex;align-items:baseline;gap:6px">
            ‚Çπ${fmtN(p.price)}
            ${p.mrp && p.mrp > p.price ? `<span style="font-size:11px;color:var(--text-muted);text-decoration:line-through">‚Çπ${fmtN(p.mrp)}</span><span style="font-size:10px;color:var(--success);font-weight:800">${p.discount_percent}% off</span>` : ''}
          </div>
        </div>
      </div>`;
    }).join('');
    // Simple pagination
    const pag = document.getElementById('marketPagination');
    if(d.pages > 1){
      let ph = '';
      for(let i=1;i<=d.pages;i++) ph += `<button class="btn btn-ghost btn-sm ${i===d.page?'active':''}" onclick="marketPage=${i};loadMarketProducts()" style="${i===d.page?'background:var(--accent);color:#fff':''}">${i}</button>`;
      pag.innerHTML = ph;
    } else pag.innerHTML = '';
  } catch(e){
    grid.innerHTML = '<div class="empty-state"><i class="fa-solid fa-wifi"></i><p>Failed to load. Try again.</p></div>';
  }
}
document.getElementById('marketSearch').addEventListener('keydown', e => { if(e.key==='Enter'){ marketPage=1; loadMarketProducts(); } });

// Load seller data
async function loadSellerData(){
  try{
    const [prods, orders] = await Promise.all([
      AUTH.api('/api/member/my-products'),
      AUTH.api('/api/member/seller-orders')
    ]);
    // Stats
    if(prods.stats){
      document.getElementById('selProducts').textContent = prods.stats.total;
      document.getElementById('selApproved').textContent = prods.stats.approved;
    }
    if(orders.stats){
      document.getElementById('selOrders').textContent = orders.stats.total;
      document.getElementById('selEarnings').textContent = '‚Çπ' + fmtN(orders.stats.totalEarnings);
    }
    // Products list
    const list = document.getElementById('sellerProductsList');
    if(!prods.products || !prods.products.length){
      list.innerHTML = `<div class="empty-state">
        <i class="fa-solid fa-store"></i>
        <p>No products listed yet. Start selling!</p>
        <button class="btn btn-primary" style="margin-top:12px" onclick="openModal('addProductModal')"><i class="fa-solid fa-plus"></i> Add First Product</button>
      </div>`;
    } else {
      list.innerHTML = `<div style="display:grid;gap:10px">${prods.products.map(p => {
        const img = p.thumbnail || (p.images && p.images[0]);
        const statusColors = {pending:'#f59e0b',approved:'#22c55e',rejected:'#ef4444','out-of-stock':'#6b7280',draft:'#94a3b8',archived:'#6b7280'};
        return `<div style="display:flex;gap:12px;align-items:center;padding:12px;background:var(--bg-soft);border-radius:12px;border:1px solid var(--border)">
          <div style="width:60px;height:60px;border-radius:10px;overflow:hidden;background:#fff;flex-shrink:0;display:flex;align-items:center;justify-content:center">
            ${img ? `<img src="${img}" style="width:100%;height:100%;object-fit:cover"/>` : '<i class="fa-solid fa-image" style="color:var(--border);font-size:1.5rem"></i>'}
          </div>
          <div style="flex:1;min-width:0">
            <div style="font-weight:800;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${p.title}</div>
            <div style="font-size:11px;color:var(--text-muted)">${p.product_id} ‚Ä¢ ‚Çπ${fmtN(p.price)} ‚Ä¢ Stock: ${p.stock}</div>
          </div>
          <span style="font-size:11px;font-weight:800;color:${statusColors[p.status]||'#6b7280'};background:${statusColors[p.status]||'#6b7280'}15;padding:3px 10px;border-radius:8px;text-transform:uppercase">${p.status}</span>
          <button class="btn btn-ghost btn-sm" onclick="deleteProduct('${p.product_id}')" title="Delete"><i class="fa-solid fa-trash" style="color:#ef4444"></i></button>
        </div>`;
      }).join('')}</div>`;
    }
    // Orders
    const tbody = document.getElementById('sellerOrdersBody');
    if(!orders.orders || !orders.orders.length){
      tbody.innerHTML = '<tr><td colspan="7" class="empty-state"><p>No orders yet</p></td></tr>';
    } else {
      tbody.innerHTML = orders.orders.map(o => `<tr>
        <td style="font-weight:700;color:var(--accent);font-size:12px">${o.order_id}</td>
        <td style="font-size:12px">${o.product_title||o.product_id}</td>
        <td style="font-size:12px">${o.buyer_name}<br><span style="color:var(--text-muted)">${o.buyer_contact}</span></td>
        <td>${o.quantity}</td>
        <td style="font-weight:700">‚Çπ${fmtN(o.total_amount)}</td>
        <td>${statusBadge(o.status)}</td>
        <td style="color:var(--text-muted);font-size:12px">${fmtDate(o.created_at)}</td>
      </tr>`).join('');
    }
  } catch(e){
    console.error('Seller data error:', e);
  }
}

async function deleteProduct(productId){
  if(!confirm('Delete this product?')) return;
  try{
    await AUTH.api('/api/member/product/' + productId, { method:'DELETE' });
    notify('Product deleted','success');
    loadSellerData();
  } catch(e){ notify(e.message||'Failed','error'); }
}

/* ============================================
   MODALS
   ============================================ */
function openModal(id){ 
  const modal = document.getElementById(id);
  if(modal.classList.contains('modal-overlay')){
    modal.classList.remove('hidden'); 
  } else {
    modal.classList.add('show');
  }
}
function closeModal(id){ 
  const modal = document.getElementById(id);
  if(modal.classList.contains('modal-overlay')){
    modal.classList.add('hidden'); 
  } else {
    modal.classList.remove('show');
  }
}

/* ============================================
   UTILITIES
   ============================================ */
function fmtN(n){ return Math.round(n||0).toLocaleString('en-IN'); }
function fmtDate(d){
  if(!d) return '‚Äî';
  try{ return new Date(d).toLocaleDateString('en-IN',{day:'numeric',month:'short',year:'numeric'}); }
  catch(e){ return d; }
}
function notify(msg, type){
  if(typeof FWF_Notify !== 'undefined') FWF_Notify.toast(msg, type);
  else alert(msg);
}
function statusBadge(s){
  const map = {active:'b-active',inactive:'b-inactive',open:'b-open','in-progress':'b-progress',resolved:'b-resolved',closed:'b-closed',pending:'b-pending',donation:'b-active',referral:'b-open',quiz:'b-progress',redeem:'b-closed'};
  return `<span class="badge ${map[s]||'b-open'}">${s}</span>`;
}

/* ============================================
   MEMBER DATA
   ============================================ */
let memberData = null;

async function loadDashboard(){
  try {
    const data = await AUTH.api('/api/member/me');
    memberData = data;
    const u = data.user || {};
    const w = data.wallet || {};

    // Welcome
    document.getElementById('welcomeName').textContent = 'Welcome, ' + (u.name || 'Member') + '!';
    document.getElementById('welcomeId').textContent = u.member_id || 'FWF-000000';
    document.getElementById('memberBadge').innerHTML = `<i class="fa-solid fa-circle-check"></i> ${u.member_id || 'Member'}`;

    // Home stats
    document.getElementById('hPoints').textContent = fmtN(w.points_balance || w.total_points_earned);
    document.getElementById('hWallet').textContent = '‚Çπ' + fmtN(w.balance_inr);
    document.getElementById('hReferrals').textContent = fmtN(data.referralStats?.total || 0);
    document.getElementById('hDonations').textContent = '‚Çπ' + fmtN(data.recentDonations?.reduce((s,d)=>s+(d.amount||0),0) || 0);

    // Recent activity on home
    if(data.pointsLedger && data.pointsLedger.length){
      document.getElementById('homeActivity').innerHTML = data.pointsLedger.slice(0,5).map(p => `
        <div style="display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid #f1f5f9">
          <div style="width:32px;height:32px;border-radius:8px;background:var(--accent-soft);color:var(--accent);display:flex;align-items:center;justify-content:center;font-size:12px">
            <i class="fa-solid fa-${p.type==='donation'?'heart':p.type==='referral'?'user-plus':p.type==='quiz'?'ticket':'star'}"></i>
          </div>
          <div style="flex:1">
            <div style="font-size:12px;font-weight:700">${p.description||p.type}</div>
            <div style="font-size:11px;color:var(--text-muted)">${fmtDate(p.created_at)}</div>
          </div>
          <div style="font-weight:800;color:var(--success);font-size:13px">+${p.points}</div>
        </div>
      `).join('');
    }

    // Cache for profile
    populateProfile(data);

  } catch(e){
    notify('Session expired. Redirecting...', 'error');
    setTimeout(() => location.href = '/member-login', 2000);
  }
}

function populateProfile(data){
  const u = data.user || {};
  const initials = (u.name||'M').split(' ').map(w=>w[0]).join('').substring(0,2).toUpperCase();
  document.getElementById('profileAvatar').textContent = initials;
  document.getElementById('profileName').textContent = u.name || 'Member';
  document.getElementById('profileId').textContent = u.member_id || '';
  document.getElementById('profileMobile').textContent = u.mobile || '‚Äî';
  document.getElementById('profileEmail').textContent = u.email || '‚Äî';
  document.getElementById('profileJoined').textContent = fmtDate(u.created_at);
  document.getElementById('profileStatus').textContent = u.membership_active ? 'Active' : 'Expired';
  document.getElementById('profileStatus').style.color = u.membership_active ? 'var(--success)' : 'var(--danger)';
  document.getElementById('editName').value = u.name || '';
  document.getElementById('editBio').value = u.bio || '';

  // Dashboard ID Card
  document.getElementById('dashCardName').textContent = u.name || 'Member';
  document.getElementById('dashCardId').textContent = u.member_id || 'FWF-000000';
  document.getElementById('dashCardMobile').textContent = u.mobile || '‚Äî';
  document.getElementById('dashCardJoined').textContent = fmtDate(u.created_at);

  // Profile ID Card
  document.getElementById('cardName').textContent = u.name || 'Member';
  document.getElementById('cardId').textContent = u.member_id || '';
  document.getElementById('cardMobile').textContent = u.mobile || '‚Äî';
  document.getElementById('cardJoined').textContent = fmtDate(u.created_at);
}

function loadProfile(){
  if(memberData) populateProfile(memberData);
}

/* ============================================
   WALLET
   ============================================ */
async function loadWallet(){
  try{
    const data = memberData || await AUTH.api('/api/member/me');
    memberData = data;
    const w = data.wallet || {};

    // Overview stats
    document.getElementById('walletTotalPoints').textContent = fmtN(w.points_balance || w.total_points_earned);
    document.getElementById('walletBalance').textContent = '‚Çπ' + fmtN(w.balance_inr);
    document.getElementById('walletReferrals').textContent = fmtN(data.referralStats?.total || 0);
    document.getElementById('walletDonations').textContent = '‚Çπ' + fmtN(data.recentDonations?.reduce((s,d)=>s+(d.amount||0),0) || 0);

    // Points section stats
    document.getElementById('wPoints').textContent = fmtN(w.points_balance || w.total_points_earned);
    document.getElementById('wDonPts').textContent = fmtN(w.points_from_donations);
    document.getElementById('wRefPts').textContent = fmtN(w.points_from_referrals);
    document.getElementById('wQuizPts').textContent = fmtN(w.points_from_quiz);

    // Points summary (new)
    document.getElementById('pointsDonSummary').textContent = fmtN(w.points_from_donations) + ' pts';
    document.getElementById('pointsRefSummary').textContent = fmtN(w.points_from_referrals) + ' pts';
    document.getElementById('pointsQuizSummary').textContent = fmtN(w.points_from_quiz) + ' pts';

    // Referral code
    document.getElementById('refCode').value = data.user?.referral_code || 'N/A';

    // Points history
    const pts = data.recentPoints || [];
    const tbody = document.getElementById('pointsHistoryBody');
    if(pts.length){
      tbody.innerHTML = pts.map(p => `<tr>
        <td>${statusBadge(p.type)}</td>
        <td style="font-weight:800;color:var(--success)">+${p.points}</td>
        <td style="font-size:12px">${p.description||'‚Äî'}</td>
        <td style="color:var(--text-muted);font-size:12px">${fmtDate(p.created_at)}</td>
      </tr>`).join('');
    }

    // Load donations
    const dons = data.recentDonations || [];
    const donBody = document.getElementById('myDonationsBody');
    if(dons.length){
      donBody.innerHTML = dons.map(d => `<tr>
        <td>${d.donor_name || 'Anonymous'}</td>
        <td style="font-weight:800">‚Çπ${fmtN(d.amount)}</td>
        <td style="color:var(--success);font-weight:700">+${d.points_earned}</td>
        <td style="color:var(--text-muted);font-size:12px">${fmtDate(d.created_at)}</td>
      </tr>`).join('');
    }

    // Load referrals
    const refs = data.referrals || [];
    const refBody = document.getElementById('referralsBody');
    if(refs.length){
      refBody.innerHTML = refs.map(r => `<tr>
        <td style="font-weight:700">${r.referred_name || '‚Äî'}</td>
        <td style="font-family:monospace;font-size:12px">${r.referred_member_id || '‚Äî'}</td>
        <td style="font-weight:800">‚Çπ${fmtN(r.amount)}</td>
        <td style="color:var(--success);font-weight:700">+${r.points_earned}</td>
        <td>${statusBadge(r.status)}</td>
        <td style="color:var(--text-muted);font-size:12px">${fmtDate(r.created_at)}</td>
      </tr>`).join('');
    }

    // Load quiz tickets
    const quiz = data.quizStats || {};
    // TODO: Load actual quiz ticket sales when backend API is ready

  } catch(e){ notify('Failed to load wallet','error'); }
}

/* ============================================
   WALLET TABS
   ============================================ */
document.querySelectorAll('.wallet-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    const target = tab.dataset.tab;
    
    // Update tabs
    document.querySelectorAll('.wallet-tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    
    // Update sections
    document.querySelectorAll('.wallet-section').forEach(s => s.style.display = 'none');
    document.getElementById('wallet-' + target).style.display = 'block';
  });
});

/* ============================================
   REDEEM MODAL
   ============================================ */
function openRedeemModal(){
  const pts = memberData?.wallet?.points_balance || memberData?.wallet?.total_points_earned || 0;
  document.getElementById('availPointsDisplay').textContent = pts;
  openModal('redeemModal');
}

// Close modal on outside click
document.addEventListener('click', (e) => {
  if(e.target.classList.contains('modal')){
    closeModal(e.target.id);
  }
});

// Close modal on ESC key
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape'){
    document.querySelectorAll('.modal.show').forEach(m => closeModal(m.id));
  }
});

// Payment method toggle
document.getElementById('bankRadio').addEventListener('change', () => {
  document.getElementById('bankDetailsSection').style.display = 'block';
  document.getElementById('upiDetailsSection').style.display = 'none';
});

document.getElementById('upiRadio').addEventListener('change', () => {
  document.getElementById('bankDetailsSection').style.display = 'none';
  document.getElementById('upiDetailsSection').style.display = 'block';
});

async function submitRedeemRequest(){
  const points = parseFloat(document.getElementById('redeemPointsInput').value);
  const cause = document.getElementById('socialCauseSelect').value;
  const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
  
  // Validation
  if(!points || points <= 0) return notify('Enter valid points amount','warning');
  
  const availPts = memberData?.wallet?.points_balance || memberData?.wallet?.total_points_earned || 0;
  if(points > availPts) return notify(`Insufficient points! You have ${availPts} points`,'warning');
  
  if(!cause) return notify('Select a social cause','warning');
  
  let paymentDetails = {};
  
  if(paymentMethod === 'bank'){
    const acc1 = document.getElementById('accNumber1').value.trim();
    const acc2 = document.getElementById('accNumber2').value.trim();
    const ifsc = document.getElementById('ifscCode').value.trim();
    const bank = document.getElementById('bankName').value.trim();
    const holder = document.getElementById('accHolder').value.trim();
    
    if(!acc1 || !acc2 || !ifsc || !bank || !holder){
      return notify('Fill all bank details','warning');
    }
    
    if(acc1 !== acc2){
      return notify('Account numbers do not match','error');
    }
    
    paymentDetails = {
      type: 'bank',
      accountNumber: acc1,
      ifsc,
      bankName: bank,
      accountHolder: holder
    };
  } else {
    const upi = document.getElementById('upiId').value.trim();
    if(!upi) return notify('Enter UPI ID','warning');
    
    paymentDetails = {
      type: 'upi',
      upiId: upi
    };
  }
  
  try{
    document.getElementById('submitRedeemBtn').disabled = true;
    document.getElementById('submitRedeemBtn').innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Submitting...';
    
    // TODO: Send to backend API
    // For now, simulate success
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    closeModal('redeemModal');
    
    // Show success message
    if(typeof FWF_Notify !== 'undefined'){
      FWF_Notify.success(`Redemption request submitted successfully!<br><small>Your points will be received within 24 hours.</small>`, 5000);
    } else {
      notify('Request submitted! Points received within 24 hours.','success');
    }
    
    // Clear form
    document.getElementById('redeemPointsInput').value = '';
    document.getElementById('socialCauseSelect').value = '';
    document.getElementById('accNumber1').value = '';
    document.getElementById('accNumber2').value = '';
    document.getElementById('ifscCode').value = '';
    document.getElementById('bankName').value = '';
    document.getElementById('accHolder').value = '';
    document.getElementById('upiId').value = '';
    
    memberData = null;
    loadWallet();
    
  } catch(e){
    notify(e.message || 'Failed to submit request','error');
  } finally {
    document.getElementById('submitRedeemBtn').disabled = false;
    document.getElementById('submitRedeemBtn').innerHTML = '<i class="fa-solid fa-check"></i> Submit Request';
  }
}

/* ============================================
   ADD MEMBER & SUPPORTER
   ============================================ */
document.getElementById('addMemberBtn').addEventListener('click', async () => {
  const name = document.getElementById('newMemberName').value.trim();
  const mobile = document.getElementById('newMemberMobile').value.trim();
  const amount = parseFloat(document.getElementById('newMemberAmount').value);
  
  if(!name || !mobile) return notify('Enter member name and mobile','warning');
  if(mobile.length !== 10) return notify('Enter valid 10-digit mobile','warning');
  if(!amount || amount <= 0) return notify('Enter valid payment amount','warning');
  
  try{
    // TODO: Send to backend API for referral registration
    // For now, show success
    notify(`Member added! You will earn 250 points when payment is confirmed.`,'success');
    
    document.getElementById('newMemberName').value = '';
    document.getElementById('newMemberMobile').value = '';
    document.getElementById('newMemberAmount').value = '500';
    
  } catch(e){
    notify(e.message || 'Failed to add member','error');
  }
});

document.getElementById('addSupporterBtn').addEventListener('click', async () => {
  const name = document.getElementById('supporterName').value.trim();
  const contact = document.getElementById('supporterContact').value.trim();
  const role = document.getElementById('supporterRole').value.trim();
  
  if(!name || !contact) return notify('Enter supporter name and contact','warning');
  
  try{
    // TODO: Send to backend API
    notify('Supporter added successfully!','success');
    
    document.getElementById('supporterName').value = '';
    document.getElementById('supporterContact').value = '';
    document.getElementById('supporterRole').value = '';
    
  } catch(e){
    notify(e.message || 'Failed to add supporter','error');
  }
});

function loadRedeemPage(){
  // Removed - now integrated into wallet page
  if(memberData){
    const pts = memberData.wallet?.points_balance || memberData.wallet?.total_points_earned || 0;
    if(document.getElementById('availPointsDisplay')){
      document.getElementById('availPointsDisplay').textContent = pts;
    }
  }
}

function copyRefCode(){
  const code = document.getElementById('refCode').value;
  navigator.clipboard.writeText(code).then(()=> notify('Referral code copied!','success')).catch(()=>{});
}

/* ============================================
   EARN POINTS
   ============================================ */
document.getElementById('recordDonBtn').addEventListener('click', async ()=>{
  const amount = parseFloat(document.getElementById('donAmount').value);
  if(!amount || amount <= 0) return notify('Enter valid donation amount','warning');
  try{
    const r = await AUTH.api('/api/member/record-donation',{method:'POST',body:{
      amount,
      donorName: document.getElementById('donName').value.trim(),
      donorContact: document.getElementById('donContact').value.trim()
    }});
    notify(r.message || `Donation recorded! +${r.pointsEarned} points`,'success');
    document.getElementById('donAmount').value = '';
    document.getElementById('donName').value = '';
    document.getElementById('donContact').value = '';
    memberData = null; // Force refresh
    loadWallet();
  } catch(e){ notify(e.message||'Failed','error'); }
});

document.getElementById('sellTicketBtn').addEventListener('click', async ()=>{
  const buyerName = document.getElementById('tickBuyer').value.trim();
  if(!buyerName) return notify('Enter buyer name','warning');
  try{
    const r = await AUTH.api('/api/member/sell-ticket',{method:'POST',body:{
      buyerName,
      buyerContact: document.getElementById('tickContact').value.trim(),
      ticketPrice: parseFloat(document.getElementById('tickPrice').value) || 100
    }});
    notify(r.message || `Ticket recorded! +${r.pointsEarned} points`,'success');
    document.getElementById('tickBuyer').value = '';
    document.getElementById('tickContact').value = '';
    memberData = null;
    loadWallet();
  } catch(e){ notify(e.message||'Failed','error'); }
});

/* ============================================
   REDEEM
   ============================================ */
async function redeemProject(projectName, cost){
  const pts = memberData?.wallet?.points_balance || memberData?.wallet?.total_points_earned || 0;
  if(pts < cost){
    notify(`Not enough points! You need ${cost} but have ${pts}`,'warning');
    return;
  }
  if(typeof FWF_Notify !== 'undefined'){
    FWF_Notify.confirm(`Redeem ${cost} points for "${projectName}"?`, async ()=>{
      try{
        await AUTH.api('/api/member/apply-wallet',{method:'POST',body:{amount:cost}});
        notify(`Successfully redeemed ${cost} points for ${projectName}!`,'success');
        memberData = null;
        loadRedeemPage();
      } catch(e){ notify(e.message||'Redemption failed','error'); }
    });
  } else {
    if(!confirm(`Redeem ${cost} points for "${projectName}"?`)) return;
    try{
      await AUTH.api('/api/member/apply-wallet',{method:'POST',body:{amount:cost}});
      notify('Redeemed!','success');
      memberData = null;
      loadRedeemPage();
    } catch(e){ notify(e.message||'Failed','error'); }
  }
}

/* ============================================
   SUPPORT
   ============================================ */
document.getElementById('submitTicketBtn').addEventListener('click', async ()=>{
  const subject = document.getElementById('supSubject').value.trim();
  const message = document.getElementById('supMessage').value.trim();
  if(!subject || !message) return notify('Fill subject and message','warning');
  try{
    await AUTH.api('/api/member/support-ticket',{method:'POST',body:{
      subject,
      message,
      category: document.getElementById('supCategory').value
    }});
    notify('Support ticket submitted!','success');
    document.getElementById('supSubject').value = '';
    document.getElementById('supMessage').value = '';
    loadMyTickets();
  } catch(e){ notify(e.message||'Failed','error'); }
});

async function loadMyTickets(){
  try{
    const d = await AUTH.api('/api/member/support-tickets');
    const tbody = document.getElementById('myTicketsBody');
    if(!d.tickets || !d.tickets.length){
      tbody.innerHTML = '<tr><td colspan="5" class="empty-state"><p>No tickets submitted</p></td></tr>';
      return;
    }
    tbody.innerHTML = d.tickets.map(t => `<tr>
      <td style="font-weight:700;color:var(--accent)">${t.ticket_id}</td>
      <td style="font-weight:700;font-size:12px">${t.subject}</td>
      <td>${statusBadge(t.status)}</td>
      <td style="font-size:12px;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${t.admin_reply||'‚Äî'}</td>
      <td style="color:var(--text-muted);font-size:12px">${fmtDate(t.created_at)}</td>
    </tr>`).join('');
  } catch(e){}
}

/* ============================================
   PROFILE UPDATE
   ============================================ */
document.getElementById('saveProfileBtn').addEventListener('click', async ()=>{
  const name = document.getElementById('editName').value.trim();
  const bio = document.getElementById('editBio').value.trim();
  try{
    await AUTH.api('/api/member/update-profile',{method:'POST',body:{name, bio}});
    notify('Profile updated!','success');
    memberData = null;
    loadDashboard();
  } catch(e){ notify(e.message||'Failed','error'); }
});

/* ============================================
   LOGOUT
   ============================================ */
document.getElementById('logoutBtn').addEventListener('click', ()=>{
  if(typeof FWF_Notify !== 'undefined'){
    FWF_Notify.confirm('Logout from your account?', async ()=>{
      await AUTH.api('/api/auth/logout',{method:'POST'});
      notify('Logged out','success');
      setTimeout(()=> location.href = '/', 1000);
    });
  } else {
    if(confirm('Logout?')){
      AUTH.api('/api/auth/logout',{method:'POST'}).finally(()=> location.href = '/');
    }
  }
});

/* ============================================
   INIT
   ============================================ */
loadDashboard();
loadStoreCategories();
</script>
</body>
</html>
